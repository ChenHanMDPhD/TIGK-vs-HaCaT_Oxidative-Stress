###### Packages ####
library(scales)
library(cowplot)
library(devtools)
library(GEOquery)
library(limma)
library(umap)
library(DESeq2)
library("ggVennDiagram")
library(gplots)
library(BiocManager)
library(clusterProfiler)
library(org.Hs.eg.db)
library(ggplot2)
library("ReactomePA")
library(AnnotationDbi)
library(VennDiagram)
library(ggplot2)
library(openxlsx)
library(readxl)
library(stringr)
library(tidyverse)
library("illuminaHumanv4.db") #Get this library if you don't have - converts illumina probes into gene
library(biomaRt)
library("MethReg")
library(annotables)
library(enrichR)
library(ComplexHeatmap)
library("org.Mm.eg.db")
listEnrichrSites()
setEnrichrSite("Enrichr") # Human genes
dbs <- c("GO_Biological_Process_2023","GO_Molecular_Function_2023", "GO_Cellular_Component_2023", "Reactome_2022")
library(stringr)
library(dplyr)
##### correlation matrix packages
library("FactoMineR")
library(ggcorrplot)
library('corrr')
library("reshape2")
##### ggplot packages for PCA plots
# install.packages("factoextra")
library(ggplot2)
library(ggplotify)
library(ggrepel)
library(factoextra)
library(ggforce)
###### Reading in the data ####
counts.H2O2<-read.csv("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/gene_counts.csv")
counts.H2O2<-counts.H2O2%>%filter(gene_biotype == "protein_coding") #Only reading mRNA/protein coding
rownames(counts.H2O2)<-counts.H2O2[,1]
colnames(counts.H2O2)

###### Differential Expression Analysis using DESeq2 and count matrix ####
# Generating PCA plot ####
coldata.H2O2.PCA<-matrix(c("Tctrl1","Tctrl2","Tctrl3","TH2O21","TH2O22","TH2O23","Hctrl1","Hctrl2","Hctrl3","HH2O21","HH2O22","HH2O23",
                           "TIGK-Ctrl","TIGK-Ctrl","TIGK-Ctrl","TIGK-H2O2","TIGK-H2O2","TIGK-H2O2", "HaCaT-Ctrl","HaCaT-Ctrl","HaCaT-Ctrl","HaCaT-H2O2","HaCaT-H2O2","HaCaT-H2O2",
                           "TIGK","TIGK","TIGK","TIGK","TIGK","TIGK", "HaCaT","HaCaT","HaCaT","HaCaT","HaCaT","HaCaT"),
                            nrow = 12,
                            ncol = 3,
                            byrow = FALSE)
colnames(coldata.H2O2.PCA)<-c("sample","exp.group","cell-line")
colnames(counts.H2O2)
dds.H2O2.PCA2<-DESeqDataSetFromMatrix(countData = counts.H2O2[,2:13],
                                         colData = coldata.H2O2.PCA,
                                         design = ~ exp.group)

#filtering all datasets: keep only avg counts >=10
keep<-rowMeans(counts(dds.H2O2.PCA2))>=10 #could do rowsums too
dds.H2O2.PCA2<-dds.H2O2.PCA2[keep,] 

#transformation of data
rld.H2O2.PCA2<-vst(dds.H2O2.PCA2, blind=FALSE)

pcaData2<- plotPCA(rld.H2O2.PCA2, intgroup=c("sample","exp.group","cell-line"), returnData=TRUE)

#Making the plots

attr(pcaData2, "percentVar")
scale_map <- data.frame(name = c("TIGK-Ctrl", "TIGK-H2O2","HaCaT-Ctrl", "HaCaT-H2O2"),
                        color = c("red", "chartreuse4", "blue","chartreuse"),
                        shape = c(15, 16, 15,16))
ggplot(pcaData2, aes(x = PC1, y = PC2,shape = pcaData2$exp.group, colour = pcaData2$exp.group)) + 
  geom_point(size=4) +
  scale_color_manual(values = scale_map$color, labels = scale_map$name,
                     name = "Samples") + 
  scale_shape_manual(values = scale_map$shape, labels = scale_map$name,
                     name = "Samples") + xlab("PC1 (89.7%)") + ylab("PC2 (8.8%)")+
  theme(axis.title.x=element_text(size = 15), axis.title.y=element_text(size = 15), axis.text.x=element_text(size = 15), axis.text.y=element_text(size = 15), 
        legend.text = element_text(size=12))

# Generating averaged correlation matrix ####
colnames(counts.H2O2)
DF<-counts.H2O2[,2:13]
keep<-rowMeans((DF))>=10 #could do rowsums too
DF<-DF[keep,] 
nrow(DF)
colnames(DF)
colnames(DF)<-c("TCtrl","TCtrl","TCtrl","TH2O2","TH2O2","TH2O2","HCtrl","HCtrl","HCtrl","HH2O2","HH2O2","HH2O2")
colnames(DF)

prefix <- unique(colnames(DF))
DF<-sapply(prefix, function(i) rowMeans(DF[, grepl(i, names(DF))]))
corr.avg <- round(cor(DF[,1:4]), 2) #now we have a correlation matrix where we have only groups and indvidual samples
upper_tri.avg<-get_upper_tri(corr.avg)
upper_tri.avg
melted_corr.avg<-melt(upper_tri.avg)

ggplot(data = melted_corr.avg, aes(Var2, Var1, fill = value))+
  geom_tile(color = "white")+geom_text(aes(label=value), size = 8)+
  scale_fill_gradient(
    name = "Cor", # changes legend title
    low = "blue",
    high = "red",
    limit = c(min(melted_corr.avg$value), 1),
    space = "Lab",
    guide = "colourbar",
    na.value="white"
  )+
  theme_minimal()+ 
  theme(axis.text.x = element_text(angle = 45, vjust = 1, 
                                   size = 12, hjust = 1),
        axis.text.y = element_text(angle = 45, vjust = 1, 
                                   size = 12, hjust = 1))+
  coord_fixed()


# DESeq2 DGE Analysis ####
#setting the columns to measure for DESeq2
comp.CTRL <- c(2:4, 8:10)
comp.H2O2 <- c(5:7, 11:13)
comp.TIGK.H2O2vsCtrl <- c(2:7)
comp.HaCaT.H2O2vsCtrl <-c(8:13)
colnames(counts.H2O2[,comp.CTRL])
colnames(counts.H2O2[,comp.H2O2])
colnames(counts.H2O2[,comp.TIGK.H2O2vsCtrl])
colnames(counts.H2O2[,comp.HaCaT.H2O2vsCtrl])

#Setting the column data for DESeq2
coldata.HvsT.ctrl<-matrix(c("Tctrl","Tctrl","Tctrl","Hctrl","Hctrl","Hctrl","TIGK","TIGK","TIGK","HaCaT","HaCaT","HaCaT"),
                       nrow = 6,
                       ncol = 2,
                       byrow = FALSE)
colnames(coldata.HvsT.ctrl)<-c("expGroup","sample")

coldata.HvsT.H2O2<-matrix(c("TH2O2","TH2O2","TH2O2","HH2O2","HH2O2","HH2O2","TIGK","TIGK","TIGK","HaCaT","HaCaT","HaCaT"),
                          nrow = 6,
                          ncol = 2,
                          byrow = FALSE)
colnames(coldata.HvsT.H2O2)<-c("expGroup","sample")

coldata.H2O2vsCtrl.TIGK<-matrix(c("Tctrl","Tctrl","Tctrl","TH2O2","TH2O2","TH2O2","TIGK","TIGK","TIGK","TIGK-H2O2","TIGK-H2O2","TIGK-H2O2"),
                          nrow = 6,
                          ncol = 2,
                          byrow = FALSE)
colnames(coldata.H2O2vsCtrl.TIGK)<-c("expGroup","sample")

coldata.H2O2vsCtrl.HaCaT<-matrix(c("Hctrl","Hctrl","Hctrl","HH2O2","HH2O2","HH2O2","HaCaT","HaCaT","HaCaT","HaCaT-H2O2","HaCaT-H2O2","HaCaT-H2O2"),
                               nrow = 6,
                               ncol = 2,
                               byrow = FALSE)
colnames(coldata.H2O2vsCtrl.HaCaT)<-c("expGroup","sample")


#DESeq2 analysis
dds.HvsT.Ctrl<-DESeqDataSetFromMatrix(countData = counts.H2O2[,comp.CTRL],
                                   colData = coldata.HvsT.ctrl,
                                   design = ~ sample)


dds.HvsT.H2O2<-DESeqDataSetFromMatrix(countData = counts.H2O2[,comp.H2O2],
                                   colData = coldata.HvsT.H2O2,
                                   design = ~ sample)


dds.H2O2vsCtrl.TIGK<-DESeqDataSetFromMatrix(countData = counts.H2O2[,comp.TIGK.H2O2vsCtrl],
                                    colData = coldata.H2O2vsCtrl.TIGK,
                                    design = ~ sample)

dds.H2O2vsCtrl.HaCaT<-DESeqDataSetFromMatrix(countData = counts.H2O2[,comp.HaCaT.H2O2vsCtrl],
                                           colData = coldata.H2O2vsCtrl.HaCaT,
                                           design = ~ sample)

#filtering all datasets: keep only avg counts >=10
keep<-rowMeans(counts(dds.HvsT.Ctrl))>=10 #could do rowsums too
dds.HvsT.Ctrl<-dds.HvsT.Ctrl[keep,] 

keep<-rowMeans(counts(dds.HvsT.H2O2))>=10
dds.HvsT.H2O2<-dds.HvsT.H2O2[keep,]

keep<-rowMeans(counts(dds.H2O2vsCtrl.TIGK))>=10
dds.H2O2vsCtrl.TIGK<-dds.H2O2vsCtrl.TIGK[keep,]

keep<-rowMeans(counts(dds.H2O2vsCtrl.HaCaT))>=10 #could do rowsums too
dds.H2O2vsCtrl.HaCaT<-dds.H2O2vsCtrl.HaCaT[keep,] 

#set the factor level (reference)
dds.HvsT.Ctrl$sample<-relevel(dds.HvsT.Ctrl$sample, ref = "TIGK")
dds.HvsT.H2O2$sample<-relevel(dds.HvsT.H2O2$sample, ref = "TIGK")
dds.H2O2vsCtrl.TIGK$sample<-relevel(dds.H2O2vsCtrl.TIGK$sample, ref = "TIGK")
dds.H2O2vsCtrl.HaCaT$sample<-relevel(dds.H2O2vsCtrl.HaCaT$sample, ref = "HaCaT")

#running DESeq: HaCaT vs TIGK (Untreated Control)
dds.HvsT.Ctrl<- DESeq(dds.HvsT.Ctrl)
res.HvsT.Ctrl<-results(dds.HvsT.Ctrl)
write.csv(res.HvsT.Ctrl, file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/DESeqResults_No gene names/DEGs-HvsT.ctrl.csv")
res.HvsT.Ctrl<-read.csv("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/DESeqResults_No gene names/DEGs-HvsT.ctrl.csv")

res.HvsT.Ctrl<-res.HvsT.Ctrl %>% 
  dplyr::arrange(padj) %>% 
  dplyr::inner_join(grch38, by = c("X" = "ensgene"))
res.HvsT.Ctrl <- res.HvsT.Ctrl[!duplicated(res.HvsT.Ctrl$symbol),] 
na.omit(res.HvsT.Ctrl)

write.csv(res.HvsT.Ctrl, file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/DEGs-HvsT.ctrl.csv")
res.HvsT.Ctrl<-read.csv("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/DEGs-HvsT.ctrl.csv")

normalized_HvsT.ctrl_counts<-counts(dds.HvsT.Ctrl, normalized = TRUE)
normalized_HvsT.ctrl_counts<-as.data.frame(normalized_HvsT.ctrl_counts)
class(normalized_HvsT.ctrl_counts)
normalized_HvsT.ctrl_counts<-rownames_to_column(normalized_HvsT.ctrl_counts, "ENSEMBL")

normalized_HvsT.ctrl_counts<-normalized_HvsT.ctrl_counts %>% 
  dplyr::inner_join(grch38, by = c("ENSEMBL" = "ensgene"))
normalized_HvsT.ctrl_counts <- normalized_HvsT.ctrl_counts[!duplicated(normalized_HvsT.ctrl_counts$symbol),] 
na.omit(normalized_HvsT.ctrl_counts)

write.csv(normalized_HvsT.ctrl_counts, file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/normalized gene counts/HvsT.ctrl.csv")


#running DESeq: HaCaT vs TIGK (H2O2 - Treated)
dds.HvsT.H2O2<- DESeq(dds.HvsT.H2O2)
res.HvsT.H2O2<-results(dds.HvsT.H2O2)
write.csv(res.HvsT.H2O2, file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/DESeqResults_No gene names/DEGs-HvsT.H2O2.csv")
res.HvsT.H2O2<-read.csv("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/DESeqResults_No gene names/DEGs-HvsT.H2O2.csv")

res.HvsT.H2O2<-res.HvsT.H2O2 %>% 
  dplyr::arrange(padj) %>% 
  dplyr::inner_join(grch38, by = c("X" = "ensgene"))
res.HvsT.H2O2 <- res.HvsT.H2O2[!duplicated(res.HvsT.H2O2$symbol),] 
na.omit(res.HvsT.H2O2)

write.csv(res.HvsT.H2O2, file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/DEGs-HvsT.H2O2.csv")
res.HvsT.H2O2<-read.csv("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/DEGs-HvsT.H2O2.csv")

normalized_HvsT.H2O2_counts<-counts(dds.HvsT.H2O2, normalized = TRUE)
normalized_HvsT.H2O2_counts<-as.data.frame(normalized_HvsT.H2O2_counts)
class(normalized_HvsT.H2O2_counts)
normalized_HvsT.H2O2_counts<-rownames_to_column(normalized_HvsT.H2O2_counts, "ENSEMBL")

normalized_HvsT.H2O2_counts<-normalized_HvsT.H2O2_counts %>% 
  dplyr::inner_join(grch38, by = c("ENSEMBL" = "ensgene"))
normalized_HvsT.H2O2_counts <- normalized_HvsT.H2O2_counts[!duplicated(normalized_HvsT.H2O2_counts$symbol),] 
na.omit(normalized_HvsT.H2O2_counts)

write.csv(normalized_HvsT.H2O2_counts, file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/normalized gene counts/HvsT.H2O2.csv")


#running DESeq: HaCaT(H2O2 - Treated) vs HaCaT(Untreated Control)
dds.H2O2vsCtrl.HaCaT<- DESeq(dds.H2O2vsCtrl.HaCaT)
res.H2O2vsCtrl.HaCaT<-results(dds.H2O2vsCtrl.HaCaT)
write.csv(res.H2O2vsCtrl.HaCaT, file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/DESeqResults_No gene names/DEGs-H2O2vsCtrl.HaCaT.csv")
res.H2O2vsCtrl.HaCaT<-read.csv("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/DESeqResults_No gene names/DEGs-H2O2vsCtrl.HaCaT.csv")

res.H2O2vsCtrl.HaCaT<-res.H2O2vsCtrl.HaCaT %>% 
  dplyr::arrange(padj) %>% 
  dplyr::inner_join(grch38, by = c("X" = "ensgene"))
res.H2O2vsCtrl.HaCaT <- res.H2O2vsCtrl.HaCaT[!duplicated(res.H2O2vsCtrl.HaCaT$symbol),] 
na.omit(res.H2O2vsCtrl.HaCaT)

write.csv(res.H2O2vsCtrl.HaCaT, file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/DEGs-H2O2vsCtrl.HaCaT.csv")
res.H2O2vsCtrl.HaCaT<-read.csv("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/DEGs-H2O2vsCtrl.HaCaT.csv")

normalized_H2O2vsCtrl.HaCaT_counts<-counts(dds.H2O2vsCtrl.HaCaT, normalized = TRUE)
normalized_H2O2vsCtrl.HaCaT_counts<-as.data.frame(normalized_H2O2vsCtrl.HaCaT_counts)
class(normalized_H2O2vsCtrl.HaCaT_counts)
normalized_H2O2vsCtrl.HaCaT_counts<-rownames_to_column(normalized_H2O2vsCtrl.HaCaT_counts, "ENSEMBL")

normalized_H2O2vsCtrl.HaCaT_counts<-normalized_H2O2vsCtrl.HaCaT_counts %>% 
  dplyr::inner_join(grch38, by = c("ENSEMBL" = "ensgene"))
normalized_H2O2vsCtrl.HaCaT_counts <- normalized_H2O2vsCtrl.HaCaT_counts[!duplicated(normalized_H2O2vsCtrl.HaCaT_counts$symbol),] 
na.omit(normalized_H2O2vsCtrl.HaCaT_counts)

write.csv(normalized_H2O2vsCtrl.HaCaT_counts, file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/normalized gene counts/H2O2vsCtrl.HaCaT.csv")

#running DESeq: TIGK(H2O2 - Treated) vs TIGK(Untreated Control)
dds.H2O2vsCtrl.TIGK<- DESeq(dds.H2O2vsCtrl.TIGK)
res.H2O2vsCtrl.TIGK<-results(dds.H2O2vsCtrl.TIGK)
write.csv(res.H2O2vsCtrl.TIGK, file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/DESeqResults_No gene names/DEGs-H2O2vsCtrl.TIGK.csv")
res.H2O2vsCtrl.TIGK<-read.csv("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/DESeqResults_No gene names/DEGs-H2O2vsCtrl.TIGK.csv")

res.H2O2vsCtrl.TIGK<-res.H2O2vsCtrl.TIGK %>% 
  dplyr::arrange(padj) %>% 
  dplyr::inner_join(grch38, by = c("X" = "ensgene"))
res.H2O2vsCtrl.TIGK <- res.H2O2vsCtrl.TIGK[!duplicated(res.H2O2vsCtrl.TIGK$symbol),] 
na.omit(res.H2O2vsCtrl.TIGK)

write.csv(res.H2O2vsCtrl.TIGK, file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/DEGs-H2O2vsCtrl.TIGK.csv")
res.H2O2vsCtrl.TIGK<-read.csv("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/DEGs-H2O2vsCtrl.TIGK.csv")

normalized_H2O2vsCtrl.TIGK_counts<-counts(dds.H2O2vsCtrl.TIGK, normalized = TRUE)
normalized_H2O2vsCtrl.TIGK_counts<-as.data.frame(normalized_H2O2vsCtrl.TIGK_counts)
class(normalized_H2O2vsCtrl.TIGK_counts)
normalized_H2O2vsCtrl.TIGK_counts<-rownames_to_column(normalized_H2O2vsCtrl.TIGK_counts, "ENSEMBL")

normalized_H2O2vsCtrl.TIGK_counts<-normalized_H2O2vsCtrl.TIGK_counts %>% 
  dplyr::inner_join(grch38, by = c("ENSEMBL" = "ensgene"))
normalized_H2O2vsCtrl.TIGK_counts <- normalized_H2O2vsCtrl.TIGK_counts[!duplicated(normalized_H2O2vsCtrl.TIGK_counts$symbol),] 
na.omit(normalized_H2O2vsCtrl.TIGK_counts)

write.csv(normalized_H2O2vsCtrl.TIGK_counts, file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/normalized gene counts/H2O2vsCtrl.TIGK.csv")

# Volcanoe Plots for all DEGs ####
#Untreated Control Comparisons
res.HvsT.Ctrl$diffexpressed <- "No Differential Expression"
res.HvsT.Ctrl$diffexpressed[res.HvsT.Ctrl$log2FoldChange > 0 & res.HvsT.Ctrl$padj < 0.01] <- "Upregulated in HaCaT"
res.HvsT.Ctrl$diffexpressed[res.HvsT.Ctrl$log2FoldChange < 0 & res.HvsT.Ctrl$padj < 0.01] <- "Upregulated in TIGK"

ggplot(data=res.HvsT.Ctrl, aes(x=log2FoldChange, y=-log10(padj), col=diffexpressed)) + 
  scale_fill_manual(values = c("No Differential Expression" = "#2CA02CFF", "Upregulated in HaCaT" = "#1F77B4FF", "Upregulated in TIGK" = "#D62728FF")) +
  theme(axis.title.x=element_text(size = 20), axis.title.y=element_text(size = 20), axis.text.x=element_text(size = 20), axis.text.y=element_text(size = 20), 
        legend.text = element_text(size=20), legend.title = element_blank(), panel.background = element_rect(fill = 'white'),
        panel.grid.major = element_line(color = "grey", linewidth = 0.25),panel.grid.minor = element_line(color = "grey", linewidth = 0.25) )+
  geom_point(aes(colour=diffexpressed, fill=diffexpressed), size = 5, alpha = 1, shape = 21,colour = "black") + 
  geom_vline(xintercept=c(0), col="red", linewidth = 3) +   geom_hline(yintercept=-log10(0.01), col="red", linewidth = 3) 

#H2O2 Treated Control Comparisons
res.HvsT.H2O2$diffexpressed <- "No Differential Expression"
res.HvsT.H2O2$diffexpressed[res.HvsT.H2O2$log2FoldChange > 0 & res.HvsT.H2O2$padj < 0.01] <- "Upregulated in HaCaT"
res.HvsT.H2O2$diffexpressed[res.HvsT.H2O2$log2FoldChange < 0 & res.HvsT.H2O2$padj < 0.01] <- "Upregulated in TIGK"

ggplot(data=res.HvsT.H2O2, aes(x=log2FoldChange, y=-log10(padj), col=diffexpressed)) + 
  scale_fill_manual(values = c("No Differential Expression" = "#2CA02CFF", "Upregulated in HaCaT" = "#1F77B4FF", "Upregulated in TIGK" = "#D62728FF")) +
    theme(axis.title.x=element_text(size = 20), axis.title.y=element_text(size = 20), axis.text.x=element_text(size = 20), axis.text.y=element_text(size = 20), 
        legend.text = element_text(size=20), legend.title = element_blank(), panel.background = element_rect(fill = 'white'),
        panel.grid.major = element_line(color = "grey", linewidth = 0.25),panel.grid.minor = element_line(color = "grey", linewidth = 0.25) )+
  geom_point(aes(colour=diffexpressed, fill=diffexpressed), size = 5, alpha = 1, shape = 21,colour = "black") + 
  geom_vline(xintercept=c(0), col="red", linewidth = 3) +   geom_hline(yintercept=-log10(0.01), col="red", linewidth = 3) 

#H202 vs Untreated: HaCaT
res.H2O2vsCtrl.HaCaT$diffexpressed <- "No Differential Expression"
res.H2O2vsCtrl.HaCaT$diffexpressed[res.H2O2vsCtrl.HaCaT$log2FoldChange > 0 & res.H2O2vsCtrl.HaCaT$padj < 0.01] <- "Upregulated after H202"
res.H2O2vsCtrl.HaCaT$diffexpressed[res.H2O2vsCtrl.HaCaT$log2FoldChange < 0 & res.H2O2vsCtrl.HaCaT$padj < 0.01] <- "Downregulated after H202"

ggplot(data=res.H2O2vsCtrl.HaCaT, aes(x=log2FoldChange, y=-log10(padj), col=diffexpressed)) + 
  scale_fill_manual(values = c("No Differential Expression" = "#2CA02CFF", "Upregulated after H202" = "#1F77B4FF", "Downregulated after H202" = "#D62728FF")) +
  theme(axis.title.x=element_text(size = 20), axis.title.y=element_text(size = 20), axis.text.x=element_text(size = 20), axis.text.y=element_text(size = 20), 
        legend.text = element_text(size=20), legend.title = element_blank(), panel.background = element_rect(fill = 'white'),
        panel.grid.major = element_line(color = "grey", linewidth = 0.25),panel.grid.minor = element_line(color = "grey", linewidth = 0.25) )+
  geom_point(aes(colour=diffexpressed, fill=diffexpressed), size = 5, alpha = 1, shape = 21,colour = "black") + 
  geom_vline(xintercept=c(0), col="red", linewidth = 3) +   geom_hline(yintercept=-log10(0.01), col="red", linewidth = 3) 

#H202 vs Untreated: TIGK
res.H2O2vsCtrl.TIGK$diffexpressed <- "No Differential Expression"
res.H2O2vsCtrl.TIGK$diffexpressed[res.H2O2vsCtrl.TIGK$log2FoldChange > 0 & res.H2O2vsCtrl.TIGK$padj < 0.01] <- "Upregulated after H202"
res.H2O2vsCtrl.TIGK$diffexpressed[res.H2O2vsCtrl.TIGK$log2FoldChange < 0 & res.H2O2vsCtrl.TIGK$padj < 0.01] <- "Downregulated after H202"

ggplot(data=res.H2O2vsCtrl.TIGK, aes(x=log2FoldChange, y=-log10(padj), col=diffexpressed)) + 
  scale_fill_manual(values = c("No Differential Expression" = "#2CA02CFF", "Upregulated after H202" = "#1F77B4FF", "Downregulated after H202" = "#D62728FF")) +
  theme(axis.title.x=element_text(size = 20), axis.title.y=element_text(size = 20), axis.text.x=element_text(size = 20), axis.text.y=element_text(size = 20), 
        legend.text = element_text(size=20), legend.title = element_blank(), panel.background = element_rect(fill = 'white'),
        panel.grid.major = element_line(color = "grey", linewidth = 0.25),panel.grid.minor = element_line(color = "grey", linewidth = 0.25) )+
  geom_point(aes(colour=diffexpressed, fill=diffexpressed), size = 5, alpha = 1, shape = 21,colour = "black") + 
  geom_vline(xintercept=c(0), col="red", linewidth = 3) +   geom_hline(yintercept=-log10(0.01), col="red", linewidth = 3) 

# Acquiring list of DEGs using p.adj < 0.01 as cutoff (Cutoff 1)####
HvsT.Ctrl<-res.HvsT.Ctrl%>%filter(padj <  0.01)
HvsT.H2O2<-res.HvsT.H2O2%>%filter(padj <  0.01)
H2O2vsCtrl.HaCaT<-res.H2O2vsCtrl.HaCaT%>%filter(padj <  0.01)
H2O2vsCtrl.TIGK<-res.H2O2vsCtrl.TIGK%>%filter(padj <  0.01)

write.csv(HvsT.Ctrl, file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/HvsT.Untreated.Cutoff1 DEGs.csv")
write.csv(HvsT.H2O2, file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/HvsT.H2O2.Cutoff1 DEGs.csv")
write.csv(H2O2vsCtrl.HaCaT, file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/H2O2vsCtrl.HaCaT.Cutoff1 DEGs.csv")
write.csv(H2O2vsCtrl.TIGK, file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/H2O2vsCtrl.TIGK.Cutoff1 DEGs.csv")

HvsT.Ctrl<-read.csv(file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/HvsT.Untreated.Cutoff1 DEGs.csv")
HvsT.H2O2<-read.csv(file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/HvsT.H2O2.Cutoff1 DEGs.csv")
H2O2vsCtrl.HaCaT<-read.csv(file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/H2O2vsCtrl.HaCaT.Cutoff1 DEGs.csv")
H2O2vsCtrl.TIGK<-read.csv(file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/H2O2vsCtrl.TIGK.Cutoff1 DEGs.csv")

HvsT.Ctrl.upTIGK<-HvsT.Ctrl%>%filter(padj <  0.01 & log2FoldChange < 0)
HvsT.Ctrl.upHaCaT<-HvsT.Ctrl%>%filter(padj <  0.01 & log2FoldChange > 0)
HvsT.H2O2.upTIGK<-HvsT.H2O2%>%filter(padj <  0.01 & log2FoldChange < 0)
HvsT.H2O2.upHaCaT<-HvsT.H2O2%>%filter(padj <  0.01 & log2FoldChange > 0)
H2O2vsCtrl.HaCaT.upCtrl<-H2O2vsCtrl.HaCaT%>%filter(padj <  0.01 & log2FoldChange < 0)
H2O2vsCtrl.HaCaT.upH2O2<-H2O2vsCtrl.HaCaT%>%filter(padj <  0.01 & log2FoldChange > 0)
H2O2vsCtrl.TIGK.upCtrl<-H2O2vsCtrl.TIGK%>%filter(padj <  0.01 & log2FoldChange < 0)
H2O2vsCtrl.TIGK.upH2O2<-H2O2vsCtrl.TIGK%>%filter(padj <  0.01 & log2FoldChange > 0)


write.csv(HvsT.Ctrl.upTIGK,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/HvsT_Ctrl_up TIGK.csv")
write.csv(HvsT.Ctrl.upHaCaT,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/HvsT_Ctrl_up HaCaT.csv")
write.csv(HvsT.H2O2.upTIGK,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/HvsT_H2O2 Treatment_up TIGK.csv")
write.csv(HvsT.H2O2.upHaCaT,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/HvsT_H2O2 Treatment_up HaCaT.csv")
write.csv(H2O2vsCtrl.HaCaT.upCtrl,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/HaCaT_H2O2 vs Ctrl_downreg after treatment.csv")
write.csv(H2O2vsCtrl.HaCaT.upH2O2,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/HaCaT_H2O2 vs Ctrl_upreg after treatment.csv")
write.csv(H2O2vsCtrl.TIGK.upCtrl,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/TIGK_H2O2 vs Ctrl_downreg after treatment.csv")
write.csv(H2O2vsCtrl.TIGK.upH2O2,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/DGE Analysis/TIGK_H2O2 vs Ctrl_upreg after treatment.csv")

###### EnrichR Gene Enrichment Analysis using DEGs (Cutoff 1)####
# Enrichment: HvsT Control ####
HvsT.Ctrl.upTIGK<-HvsT.Ctrl%>%filter(padj <  0.01 & log2FoldChange < 0)
HvsT.Ctrl.upHaCaT<-HvsT.Ctrl%>%filter(padj <  0.01 & log2FoldChange > 0)

enriched.HvsT.Ctrl.upTIGK <- enrichr(HvsT.Ctrl.upTIGK$symbol, dbs)
enriched.HvsT.Ctrl.upHaCaT <- enrichr(HvsT.Ctrl.upHaCaT$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up HaCaT")
addWorksheet(Enrichments, "CC Up HaCaT")
addWorksheet(Enrichments, "MF Up HaCaT")
addWorksheet(Enrichments, "Reactome Up HaCaT")
addWorksheet(Enrichments, "BP Up TIGK")
addWorksheet(Enrichments, "CC Up TIGK")
addWorksheet(Enrichments, "MF Up TIGK")
addWorksheet(Enrichments, "Reactome Up TIGK")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up HaCaT", x = as.data.frame(enriched.HvsT.Ctrl.upHaCaT$GO_Biological_Process_2023))
writeData(Enrichments, sheet = "CC Up HaCaT", x = as.data.frame(enriched.HvsT.Ctrl.upHaCaT$GO_Cellular_Component_2023))
writeData(Enrichments, sheet = "MF Up HaCaT", x = as.data.frame(enriched.HvsT.Ctrl.upHaCaT$GO_Molecular_Function_2023))
writeData(Enrichments, sheet = "Reactome Up HaCaT", x = as.data.frame(enriched.HvsT.Ctrl.upHaCaT$Reactome_2022))
writeData(Enrichments, sheet = "BP Up TIGK",  x = as.data.frame(enriched.HvsT.Ctrl.upTIGK$GO_Biological_Process_2023))
writeData(Enrichments, sheet = "CC Up TIGK",  x = as.data.frame(enriched.HvsT.Ctrl.upTIGK$GO_Cellular_Component_2023))
writeData(Enrichments, sheet = "MF Up TIGK",  x = as.data.frame(enriched.HvsT.Ctrl.upTIGK$GO_Molecular_Function_2023))
writeData(Enrichments, sheet = "Reactome Up TIGK", x = as.data.frame(enriched.HvsT.Ctrl.upTIGK$Reactome_2022))
# Export the file
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/HvsT_Ctrl_Enrichment.xlsx")

# Enrichment dot plots: HvsT Control comparisons - HaCaT ####
#GO BP
enriched.HvsT.Ctrl.upHaCaT.GOBP<-as.data.frame(enriched.HvsT.Ctrl.upHaCaT$GO_Biological_Process_2023)[1:10,]
frac <- enriched.HvsT.Ctrl.upHaCaT.GOBP$Overlap
enriched.HvsT.Ctrl.upHaCaT.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.HvsT.Ctrl.upHaCaT.GOBP, aes(x=enriched.HvsT.Ctrl.upHaCaT.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.HvsT.Ctrl.upHaCaT.GOBP$Adjusted.P.value, size=(enriched.HvsT.Ctrl.upHaCaT.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/HvsT_Ctrl Dotplots/HaCaT/GO BP_DEGs Up in HaCaT.png",
     width = 1600,
     height = 2000,
     units = "px",
     res = 250)
p1
dev.off()

#GO - MF
enriched.HvsT.Ctrl.upHaCaT.GOMF<-as.data.frame(enriched.HvsT.Ctrl.upHaCaT$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.HvsT.Ctrl.upHaCaT.GOMF$Overlap
enriched.HvsT.Ctrl.upHaCaT.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.HvsT.Ctrl.upHaCaT.GOMF, aes(x=enriched.HvsT.Ctrl.upHaCaT.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.HvsT.Ctrl.upHaCaT.GOMF$Adjusted.P.value, size=(enriched.HvsT.Ctrl.upHaCaT.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/HvsT_Ctrl Dotplots/HaCaT/GO MF_DEGs Up in HaCaT.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.HvsT.Ctrl.upHaCaT.GOCC<-as.data.frame(enriched.HvsT.Ctrl.upHaCaT$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.HvsT.Ctrl.upHaCaT.GOCC$Overlap
enriched.HvsT.Ctrl.upHaCaT.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.HvsT.Ctrl.upHaCaT.GOCC, aes(x=enriched.HvsT.Ctrl.upHaCaT.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.HvsT.Ctrl.upHaCaT.GOCC$Adjusted.P.value, size=(enriched.HvsT.Ctrl.upHaCaT.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/HvsT_Ctrl Dotplots/HaCaT/GO CC_DEGs Up in HaCaT.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.HvsT.Ctrl.upHaCaT.Reactome<-as.data.frame(enriched.HvsT.Ctrl.upHaCaT$Reactome_2022)[1:10,]
frac <- enriched.HvsT.Ctrl.upHaCaT.Reactome$Overlap
enriched.HvsT.Ctrl.upHaCaT.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.HvsT.Ctrl.upHaCaT.Reactome, aes(x=enriched.HvsT.Ctrl.upHaCaT.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.HvsT.Ctrl.upHaCaT.Reactome$Adjusted.P.value, size=(enriched.HvsT.Ctrl.upHaCaT.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/HvsT_Ctrl Dotplots/HaCaT/Reactome_DEGs Up in HaCaT.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

# Enrichment dot plots: HvsT Control comparisons - TIGK ####
#GO BP
enriched.HvsT.Ctrl.upTIGK.GOBP<-as.data.frame(enriched.HvsT.Ctrl.upTIGK$GO_Biological_Process_2023)[1:10,]
frac <- enriched.HvsT.Ctrl.upTIGK.GOBP$Overlap
enriched.HvsT.Ctrl.upTIGK.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.HvsT.Ctrl.upTIGK.GOBP, aes(x=enriched.HvsT.Ctrl.upTIGK.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.HvsT.Ctrl.upTIGK.GOBP$Adjusted.P.value, size=(enriched.HvsT.Ctrl.upTIGK.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/HvsT_Ctrl Dotplots/TIGK/GO BP_DEGs Up in TIGK.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.HvsT.Ctrl.upTIGK.GOMF<-as.data.frame(enriched.HvsT.Ctrl.upTIGK$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.HvsT.Ctrl.upTIGK.GOMF$Overlap
enriched.HvsT.Ctrl.upTIGK.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.HvsT.Ctrl.upTIGK.GOMF, aes(x=enriched.HvsT.Ctrl.upTIGK.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.HvsT.Ctrl.upTIGK.GOMF$Adjusted.P.value, size=(enriched.HvsT.Ctrl.upTIGK.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/HvsT_Ctrl Dotplots/TIGK/GO MF_DEGs Up in TIGK.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.HvsT.Ctrl.upTIGK.GOCC<-as.data.frame(enriched.HvsT.Ctrl.upTIGK$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.HvsT.Ctrl.upTIGK.GOCC$Overlap
enriched.HvsT.Ctrl.upTIGK.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.HvsT.Ctrl.upTIGK.GOCC, aes(x=enriched.HvsT.Ctrl.upTIGK.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.HvsT.Ctrl.upTIGK.GOCC$Adjusted.P.value, size=(enriched.HvsT.Ctrl.upTIGK.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/HvsT_Ctrl Dotplots/TIGK/GO CC_DEGs Up in TIGK.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.HvsT.Ctrl.upTIGK.Reactome<-as.data.frame(enriched.HvsT.Ctrl.upTIGK$Reactome_2022)[1:10,]
frac <- enriched.HvsT.Ctrl.upTIGK.Reactome$Overlap
enriched.HvsT.Ctrl.upTIGK.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.HvsT.Ctrl.upTIGK.Reactome, aes(x=enriched.HvsT.Ctrl.upTIGK.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.HvsT.Ctrl.upTIGK.Reactome$Adjusted.P.value, size=(enriched.HvsT.Ctrl.upTIGK.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/HvsT_Ctrl Dotplots/TIGK/Reactome_DEGs Up in TIGK.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

# Enrichment: HvsT H2O2 Treatment ####
HvsT.H2O2.upTIGK<-HvsT.H2O2%>%filter(padj <  0.01 & log2FoldChange < 0)
HvsT.H2O2.upHaCaT<-HvsT.H2O2%>%filter(padj <  0.01 & log2FoldChange > 0)

enriched.HvsT.H2O2.upTIGK <- enrichr(HvsT.H2O2.upTIGK$symbol, dbs)
enriched.HvsT.H2O2.upHaCaT <- enrichr(HvsT.H2O2.upHaCaT$symbol, dbs)

# Exporting HvsT H2O2 Treatment comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up HaCaT")
addWorksheet(Enrichments, "CC Up HaCaT")
addWorksheet(Enrichments, "MF Up HaCaT")
addWorksheet(Enrichments, "Reactome Up HaCaT")
addWorksheet(Enrichments, "BP Up TIGK")
addWorksheet(Enrichments, "CC Up TIGK")
addWorksheet(Enrichments, "MF Up TIGK")
addWorksheet(Enrichments, "Reactome Up TIGK")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up HaCaT", x = as.data.frame(enriched.HvsT.H2O2.upHaCaT$GO_Biological_Process_2023))
writeData(Enrichments, sheet = "CC Up HaCaT", x = as.data.frame(enriched.HvsT.H2O2.upHaCaT$GO_Cellular_Component_2023))
writeData(Enrichments, sheet = "MF Up HaCaT", x = as.data.frame(enriched.HvsT.H2O2.upHaCaT$GO_Molecular_Function_2023))
writeData(Enrichments, sheet = "Reactome Up HaCaT", x = as.data.frame(enriched.HvsT.H2O2.upHaCaT$Reactome_2022))
writeData(Enrichments, sheet = "BP Up TIGK",  x = as.data.frame(enriched.HvsT.H2O2.upTIGK$GO_Biological_Process_2023))
writeData(Enrichments, sheet = "CC Up TIGK",  x = as.data.frame(enriched.HvsT.H2O2.upTIGK$GO_Cellular_Component_2023))
writeData(Enrichments, sheet = "MF Up TIGK",  x = as.data.frame(enriched.HvsT.H2O2.upTIGK$GO_Molecular_Function_2023))
writeData(Enrichments, sheet = "Reactome Up TIGK", x = as.data.frame(enriched.HvsT.H2O2.upTIGK$Reactome_2022))
# Export the file
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/HvsT_H2O2_Enrichment.xlsx")

# Enrichment dot plots: HvsT Control comparisons - HaCaT ####
#GO BP
enriched.HvsT.H2O2.upHaCaT.GOBP<-as.data.frame(enriched.HvsT.H2O2.upHaCaT$GO_Biological_Process_2023)[1:10,]
frac <- enriched.HvsT.H2O2.upHaCaT.GOBP$Overlap
enriched.HvsT.H2O2.upHaCaT.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.HvsT.H2O2.upHaCaT.GOBP, aes(x=enriched.HvsT.H2O2.upHaCaT.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.HvsT.H2O2.upHaCaT.GOBP$Adjusted.P.value, size=(enriched.HvsT.H2O2.upHaCaT.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/HvsT_H2O2 Treatment Dotplots/HaCaT/GO BP_DEGs Up in HaCaT.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.HvsT.H2O2.upHaCaT.GOMF<-as.data.frame(enriched.HvsT.H2O2.upHaCaT$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.HvsT.H2O2.upHaCaT.GOMF$Overlap
enriched.HvsT.H2O2.upHaCaT.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.HvsT.H2O2.upHaCaT.GOMF, aes(x=enriched.HvsT.H2O2.upHaCaT.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.HvsT.H2O2.upHaCaT.GOMF$Adjusted.P.value, size=(enriched.HvsT.H2O2.upHaCaT.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/HvsT_H2O2 Treatment Dotplots/HaCaT/GO MF_DEGs Up in HaCaT.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.HvsT.H2O2.upHaCaT.GOCC<-as.data.frame(enriched.HvsT.H2O2.upHaCaT$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.HvsT.H2O2.upHaCaT.GOCC$Overlap
enriched.HvsT.H2O2.upHaCaT.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.HvsT.H2O2.upHaCaT.GOCC, aes(x=enriched.HvsT.H2O2.upHaCaT.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.HvsT.H2O2.upHaCaT.GOCC$Adjusted.P.value, size=(enriched.HvsT.H2O2.upHaCaT.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/HvsT_H2O2 Treatment Dotplots/HaCaT/GO CC_DEGs Up in HaCaT.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.HvsT.H2O2.upHaCaT.Reactome<-as.data.frame(enriched.HvsT.H2O2.upHaCaT$Reactome_2022)[1:10,]
frac <- enriched.HvsT.H2O2.upHaCaT.Reactome$Overlap
enriched.HvsT.H2O2.upHaCaT.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.HvsT.H2O2.upHaCaT.Reactome, aes(x=enriched.HvsT.H2O2.upHaCaT.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.HvsT.H2O2.upHaCaT.Reactome$Adjusted.P.value, size=(enriched.HvsT.H2O2.upHaCaT.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/HvsT_H2O2 Treatment Dotplots/HaCaT/Reactome_DEGs Up in HaCaT.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

# Enrichment dot plots: HvsT Control comparisons - TIGK ####
#GO BP
enriched.HvsT.H2O2.upTIGK.GOBP<-as.data.frame(enriched.HvsT.H2O2.upTIGK$GO_Biological_Process_2023)[1:10,]
frac <- enriched.HvsT.H2O2.upTIGK.GOBP$Overlap
enriched.HvsT.H2O2.upTIGK.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.HvsT.H2O2.upTIGK.GOBP, aes(x=enriched.HvsT.H2O2.upTIGK.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.HvsT.H2O2.upTIGK.GOBP$Adjusted.P.value, size=(enriched.HvsT.H2O2.upTIGK.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/HvsT_H2O2 Treatment Dotplots/TIGK/GO BP_DEGs Up in TIGK.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.HvsT.H2O2.upTIGK.GOMF<-as.data.frame(enriched.HvsT.H2O2.upTIGK$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.HvsT.H2O2.upTIGK.GOMF$Overlap
enriched.HvsT.H2O2.upTIGK.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.HvsT.H2O2.upTIGK.GOMF, aes(x=enriched.HvsT.H2O2.upTIGK.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.HvsT.H2O2.upTIGK.GOMF$Adjusted.P.value, size=(enriched.HvsT.H2O2.upTIGK.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/HvsT_H2O2 Treatment Dotplots/TIGK/GO MF_DEGs Up in TIGK.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.HvsT.H2O2.upTIGK.GOCC<-as.data.frame(enriched.HvsT.H2O2.upTIGK$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.HvsT.H2O2.upTIGK.GOCC$Overlap
enriched.HvsT.H2O2.upTIGK.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.HvsT.H2O2.upTIGK.GOCC, aes(x=enriched.HvsT.H2O2.upTIGK.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.HvsT.H2O2.upTIGK.GOCC$Adjusted.P.value, size=(enriched.HvsT.H2O2.upTIGK.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/HvsT_H2O2 Treatment Dotplots/TIGK/GO CC_DEGs Up in TIGK.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.HvsT.H2O2.upTIGK.Reactome<-as.data.frame(enriched.HvsT.H2O2.upTIGK$Reactome_2022)[1:10,]
frac <- enriched.HvsT.H2O2.upTIGK.Reactome$Overlap
enriched.HvsT.H2O2.upTIGK.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.HvsT.H2O2.upTIGK.Reactome, aes(x=enriched.HvsT.H2O2.upTIGK.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.HvsT.H2O2.upTIGK.Reactome$Adjusted.P.value, size=(enriched.HvsT.H2O2.upTIGK.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/HvsT_H2O2 Treatment Dotplots/TIGK/Reactome_DEGs Up in TIGK.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

# Enrichment: H2O2 vs Ctrl - HaCaT ####
H2O2vsCtrl.HaCaT.upCtrl<-H2O2vsCtrl.HaCaT%>%filter(padj <  0.01 & log2FoldChange < 0)
H2O2vsCtrl.HaCaT.upH2O2<-H2O2vsCtrl.HaCaT%>%filter(padj <  0.01 & log2FoldChange > 0)

enriched.H2O2vsCtrl.HaCaT.upCtrl <- enrichr(H2O2vsCtrl.HaCaT.upCtrl$symbol, dbs)
enriched.H2O2vsCtrl.HaCaT.upH2O2 <- enrichr(H2O2vsCtrl.HaCaT.upH2O2$symbol, dbs)

# Exporting H2O2 vs Ctrl - HaCaT comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up HaCaT H2O2")
addWorksheet(Enrichments, "CC Up HaCaT H2O2")
addWorksheet(Enrichments, "MF Up HaCaT H2O2")
addWorksheet(Enrichments, "Reactome Up HaCaT H2O2")
addWorksheet(Enrichments, "BP Up HaCaT Ctrl")
addWorksheet(Enrichments, "CC Up HaCaT Ctrl")
addWorksheet(Enrichments, "MF Up HaCaT Ctrl")
addWorksheet(Enrichments, "Reactome Up HaCaT Ctrl")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up HaCaT H2O2", x = as.data.frame(enriched.H2O2vsCtrl.HaCaT.upH2O2$GO_Biological_Process_2023))
writeData(Enrichments, sheet = "CC Up HaCaT H2O2", x = as.data.frame(enriched.H2O2vsCtrl.HaCaT.upH2O2$GO_Cellular_Component_2023))
writeData(Enrichments, sheet = "MF Up HaCaT H2O2", x = as.data.frame(enriched.H2O2vsCtrl.HaCaT.upH2O2$GO_Molecular_Function_2023))
writeData(Enrichments, sheet = "Reactome Up HaCaT H2O2", x = as.data.frame(enriched.H2O2vsCtrl.HaCaT.upH2O2$Reactome_2022))
writeData(Enrichments, sheet = "BP Up HaCaT Ctrl",  x = as.data.frame(enriched.H2O2vsCtrl.HaCaT.upCtrl$GO_Biological_Process_2023))
writeData(Enrichments, sheet = "CC Up HaCaT Ctrl",  x = as.data.frame(enriched.H2O2vsCtrl.HaCaT.upCtrl$GO_Cellular_Component_2023))
writeData(Enrichments, sheet = "MF Up HaCaT Ctrl",  x = as.data.frame(enriched.H2O2vsCtrl.HaCaT.upCtrl$GO_Molecular_Function_2023))
writeData(Enrichments, sheet = "Reactome Up HaCaT Ctrl", x = as.data.frame(enriched.H2O2vsCtrl.HaCaT.upCtrl$Reactome_2022))
# Export the file
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/H2O2 vs Ctrl_HaCaT_Enrichment.xlsx")

# Enrichment dot plots: H2O2 vs Ctrl - HaCaT: Genes upregulated after H2O2 treatment ####
#GO BP
enriched.H2O2vsCtrl.HaCaT.upH2O2.GOBP<-as.data.frame(enriched.H2O2vsCtrl.HaCaT.upH2O2$GO_Biological_Process_2023)[1:10,]
frac <- enriched.H2O2vsCtrl.HaCaT.upH2O2.GOBP$Overlap
enriched.H2O2vsCtrl.HaCaT.upH2O2.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2vsCtrl.HaCaT.upH2O2.GOBP, aes(x=enriched.H2O2vsCtrl.HaCaT.upH2O2.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2vsCtrl.HaCaT.upH2O2.GOBP$Adjusted.P.value, size=(enriched.H2O2vsCtrl.HaCaT.upH2O2.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/H2O2 Treatment vs Ctrl - HaCaT Dotplots/Upregulated after H2O2 treatment/GO BP_DEGs Up after H2O2.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.H2O2vsCtrl.HaCaT.upH2O2.GOMF<-as.data.frame(enriched.H2O2vsCtrl.HaCaT.upH2O2$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.H2O2vsCtrl.HaCaT.upH2O2.GOMF$Overlap
enriched.H2O2vsCtrl.HaCaT.upH2O2.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2vsCtrl.HaCaT.upH2O2.GOMF, aes(x=enriched.H2O2vsCtrl.HaCaT.upH2O2.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2vsCtrl.HaCaT.upH2O2.GOMF$Adjusted.P.value, size=(enriched.H2O2vsCtrl.HaCaT.upH2O2.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/H2O2 Treatment vs Ctrl - HaCaT Dotplots/Upregulated after H2O2 treatment/GO MF_DEGs Up after H2O2.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.H2O2vsCtrl.HaCaT.upH2O2.GOCC<-as.data.frame(enriched.H2O2vsCtrl.HaCaT.upH2O2$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.H2O2vsCtrl.HaCaT.upH2O2.GOCC$Overlap
enriched.H2O2vsCtrl.HaCaT.upH2O2.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2vsCtrl.HaCaT.upH2O2.GOCC, aes(x=enriched.H2O2vsCtrl.HaCaT.upH2O2.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2vsCtrl.HaCaT.upH2O2.GOCC$Adjusted.P.value, size=(enriched.H2O2vsCtrl.HaCaT.upH2O2.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/H2O2 Treatment vs Ctrl - HaCaT Dotplots/Upregulated after H2O2 treatment/GO CC_DEGs Up after H2O2.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.H2O2vsCtrl.HaCaT.upH2O2.Reactome<-as.data.frame(enriched.H2O2vsCtrl.HaCaT.upH2O2$Reactome_2022)[1:10,]
frac <- enriched.H2O2vsCtrl.HaCaT.upH2O2.Reactome$Overlap
enriched.H2O2vsCtrl.HaCaT.upH2O2.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2vsCtrl.HaCaT.upH2O2.Reactome, aes(x=enriched.H2O2vsCtrl.HaCaT.upH2O2.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2vsCtrl.HaCaT.upH2O2.Reactome$Adjusted.P.value, size=(enriched.H2O2vsCtrl.HaCaT.upH2O2.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/H2O2 Treatment vs Ctrl - HaCaT Dotplots/Upregulated after H2O2 treatment/Reactome_DEGs Up after H2O2.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

# Enrichment dot plots: H2O2 vs Ctrl - HaCaT: Genes downregulated after H2O2 treatment (higher at baseline) ####
#GO BP
enriched.H2O2vsCtrl.HaCaT.upCtrl.GOBP<-as.data.frame(enriched.H2O2vsCtrl.HaCaT.upCtrl$GO_Biological_Process_2023)[1:10,]
frac <- enriched.H2O2vsCtrl.HaCaT.upCtrl.GOBP$Overlap
enriched.H2O2vsCtrl.HaCaT.upCtrl.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2vsCtrl.HaCaT.upCtrl.GOBP, aes(x=enriched.H2O2vsCtrl.HaCaT.upCtrl.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2vsCtrl.HaCaT.upCtrl.GOBP$Adjusted.P.value, size=(enriched.H2O2vsCtrl.HaCaT.upCtrl.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/H2O2 Treatment vs Ctrl - HaCaT Dotplots/Downregulated after H2O2 treatment/GO BP_DEGs Down after H2O2.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.H2O2vsCtrl.HaCaT.upCtrl.GOMF<-as.data.frame(enriched.H2O2vsCtrl.HaCaT.upCtrl$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.H2O2vsCtrl.HaCaT.upCtrl.GOMF$Overlap
enriched.H2O2vsCtrl.HaCaT.upCtrl.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2vsCtrl.HaCaT.upCtrl.GOMF, aes(x=enriched.H2O2vsCtrl.HaCaT.upCtrl.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2vsCtrl.HaCaT.upCtrl.GOMF$Adjusted.P.value, size=(enriched.H2O2vsCtrl.HaCaT.upCtrl.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/H2O2 Treatment vs Ctrl - HaCaT Dotplots/Downregulated after H2O2 treatment/GO MF_DEGs Down after H2O2.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.H2O2vsCtrl.HaCaT.upCtrl.GOCC<-as.data.frame(enriched.H2O2vsCtrl.HaCaT.upCtrl$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.H2O2vsCtrl.HaCaT.upCtrl.GOCC$Overlap
enriched.H2O2vsCtrl.HaCaT.upCtrl.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2vsCtrl.HaCaT.upCtrl.GOCC, aes(x=enriched.H2O2vsCtrl.HaCaT.upCtrl.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2vsCtrl.HaCaT.upCtrl.GOCC$Adjusted.P.value, size=(enriched.H2O2vsCtrl.HaCaT.upCtrl.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/H2O2 Treatment vs Ctrl - HaCaT Dotplots/Downregulated after H2O2 treatment/GO CC_DEGs Down after H2O2.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.H2O2vsCtrl.HaCaT.upCtrl.Reactome<-as.data.frame(enriched.H2O2vsCtrl.HaCaT.upCtrl$Reactome_2022)[1:10,]
frac <- enriched.H2O2vsCtrl.HaCaT.upCtrl.Reactome$Overlap
enriched.H2O2vsCtrl.HaCaT.upCtrl.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2vsCtrl.HaCaT.upCtrl.Reactome, aes(x=enriched.H2O2vsCtrl.HaCaT.upCtrl.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2vsCtrl.HaCaT.upCtrl.Reactome$Adjusted.P.value, size=(enriched.H2O2vsCtrl.HaCaT.upCtrl.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/H2O2 Treatment vs Ctrl - HaCaT Dotplots/Downregulated after H2O2 treatment/Reactome_DEGs Down after H2O2.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

# Enrichment: H2O2 vs Ctrl - TIGK ####
H2O2vsCtrl.TIGK.upCtrl<-H2O2vsCtrl.TIGK%>%filter(padj <  0.01 & log2FoldChange < 0)
H2O2vsCtrl.TIGK.upH2O2<-H2O2vsCtrl.TIGK%>%filter(padj <  0.01 & log2FoldChange > 0)

enriched.H2O2vsCtrl.TIGK.upCtrl<- enrichr(H2O2vsCtrl.TIGK.upCtrl$symbol, dbs)
enriched.H2O2vsCtrl.TIGK.upH2O2 <- enrichr(H2O2vsCtrl.TIGK.upH2O2$symbol, dbs)

# Exporting H2O2 vs Ctrl - TIGK comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up TIGK H2O2")
addWorksheet(Enrichments, "CC Up TIGK H2O2")
addWorksheet(Enrichments, "MF Up TIGK H2O2")
addWorksheet(Enrichments, "Reactome Up TIGK H2O2")
addWorksheet(Enrichments, "BP Up TIGK Ctrl")
addWorksheet(Enrichments, "CC Up TIGK Ctrl")
addWorksheet(Enrichments, "MF Up TIGK Ctrl")
addWorksheet(Enrichments, "Reactome Up TIGK Ctrl")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up TIGK H2O2", x = as.data.frame(enriched.H2O2vsCtrl.TIGK.upH2O2$GO_Biological_Process_2023))
writeData(Enrichments, sheet = "CC Up TIGK H2O2", x = as.data.frame(enriched.H2O2vsCtrl.TIGK.upH2O2$GO_Cellular_Component_2023))
writeData(Enrichments, sheet = "MF Up TIGK H2O2", x = as.data.frame(enriched.H2O2vsCtrl.TIGK.upH2O2$GO_Molecular_Function_2023))
writeData(Enrichments, sheet = "Reactome Up TIGK H2O2", x = as.data.frame(enriched.H2O2vsCtrl.TIGK.upH2O2$Reactome_2022))
writeData(Enrichments, sheet = "BP Up TIGK Ctrl",  x = as.data.frame(enriched.H2O2vsCtrl.TIGK.upCtrl$GO_Biological_Process_2023))
writeData(Enrichments, sheet = "CC Up TIGK Ctrl",  x = as.data.frame(enriched.H2O2vsCtrl.TIGK.upCtrl$GO_Cellular_Component_2023))
writeData(Enrichments, sheet = "MF Up TIGK Ctrl",  x = as.data.frame(enriched.H2O2vsCtrl.TIGK.upCtrl$GO_Molecular_Function_2023))
writeData(Enrichments, sheet = "Reactome Up TIGK Ctrl", x = as.data.frame(enriched.H2O2vsCtrl.TIGK.upCtrl$Reactome_2022))
# Export the file
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/H2O2 vs Ctrl_TIGK_Enrichment.xlsx")

# Enrichment dot plots: H2O2 vs Ctrl - TIGK: Genes upregulated after H2O2 treatment ####
#GO BP
enriched.H2O2vsCtrl.TIGK.upH2O2.GOBP<-as.data.frame(enriched.H2O2vsCtrl.TIGK.upH2O2$GO_Biological_Process_2023)[1:10,]
frac <- enriched.H2O2vsCtrl.TIGK.upH2O2.GOBP$Overlap
enriched.H2O2vsCtrl.TIGK.upH2O2.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2vsCtrl.TIGK.upH2O2.GOBP, aes(x=enriched.H2O2vsCtrl.TIGK.upH2O2.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2vsCtrl.TIGK.upH2O2.GOBP$Adjusted.P.value, size=(enriched.H2O2vsCtrl.TIGK.upH2O2.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/H2O2 Treatment vs Ctrl - TIGK Dotplots/Upregulated after H2O2 treatment/GO BP_DEGs Up after H2O2.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.H2O2vsCtrl.TIGK.upH2O2.GOMF<-as.data.frame(enriched.H2O2vsCtrl.TIGK.upH2O2$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.H2O2vsCtrl.TIGK.upH2O2.GOMF$Overlap
enriched.H2O2vsCtrl.TIGK.upH2O2.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2vsCtrl.TIGK.upH2O2.GOMF, aes(x=enriched.H2O2vsCtrl.TIGK.upH2O2.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2vsCtrl.TIGK.upH2O2.GOMF$Adjusted.P.value, size=(enriched.H2O2vsCtrl.TIGK.upH2O2.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/H2O2 Treatment vs Ctrl - TIGK Dotplots/Upregulated after H2O2 treatment/GO MF_DEGs Up after H2O2.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.H2O2vsCtrl.TIGK.upH2O2.GOCC<-as.data.frame(enriched.H2O2vsCtrl.TIGK.upH2O2$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.H2O2vsCtrl.TIGK.upH2O2.GOCC$Overlap
enriched.H2O2vsCtrl.TIGK.upH2O2.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2vsCtrl.TIGK.upH2O2.GOCC, aes(x=enriched.H2O2vsCtrl.TIGK.upH2O2.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2vsCtrl.TIGK.upH2O2.GOCC$Adjusted.P.value, size=(enriched.H2O2vsCtrl.TIGK.upH2O2.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/H2O2 Treatment vs Ctrl - TIGK Dotplots/Upregulated after H2O2 treatment/GO CC_DEGs Up after H2O2.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.H2O2vsCtrl.TIGK.upH2O2.Reactome<-as.data.frame(enriched.H2O2vsCtrl.TIGK.upH2O2$Reactome_2022)[1:10,]
frac <- enriched.H2O2vsCtrl.TIGK.upH2O2.Reactome$Overlap
enriched.H2O2vsCtrl.TIGK.upH2O2.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2vsCtrl.TIGK.upH2O2.Reactome, aes(x=enriched.H2O2vsCtrl.TIGK.upH2O2.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2vsCtrl.TIGK.upH2O2.Reactome$Adjusted.P.value, size=(enriched.H2O2vsCtrl.TIGK.upH2O2.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/H2O2 Treatment vs Ctrl - TIGK Dotplots/Upregulated after H2O2 treatment/Reactome_DEGs Up after H2O2.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

# Enrichment dot plots: H2O2 vs Ctrl - TIGK: Genes downregulated after H2O2 treatment (higher at baseline) ####
#GO BP
enriched.H2O2vsCtrl.TIGK.upCtrl.GOBP<-as.data.frame(enriched.H2O2vsCtrl.TIGK.upCtrl$GO_Biological_Process_2023)[1:10,]
frac <- enriched.H2O2vsCtrl.TIGK.upCtrl.GOBP$Overlap
enriched.H2O2vsCtrl.TIGK.upCtrl.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2vsCtrl.TIGK.upCtrl.GOBP, aes(x=enriched.H2O2vsCtrl.TIGK.upCtrl.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2vsCtrl.TIGK.upCtrl.GOBP$Adjusted.P.value, size=(enriched.H2O2vsCtrl.TIGK.upCtrl.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/H2O2 Treatment vs Ctrl - TIGK Dotplots/Downregulated after H2O2 treatment/GO BP_DEGs Down after H2O2.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.H2O2vsCtrl.TIGK.upCtrl.GOMF<-as.data.frame(enriched.H2O2vsCtrl.TIGK.upCtrl$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.H2O2vsCtrl.TIGK.upCtrl.GOMF$Overlap
enriched.H2O2vsCtrl.TIGK.upCtrl.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2vsCtrl.TIGK.upCtrl.GOMF, aes(x=enriched.H2O2vsCtrl.TIGK.upCtrl.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2vsCtrl.TIGK.upCtrl.GOMF$Adjusted.P.value, size=(enriched.H2O2vsCtrl.TIGK.upCtrl.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/H2O2 Treatment vs Ctrl - TIGK Dotplots/Downregulated after H2O2 treatment/GO MF_DEGs Down after H2O2.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.H2O2vsCtrl.TIGK.upCtrl.GOCC<-as.data.frame(enriched.H2O2vsCtrl.TIGK.upCtrl$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.H2O2vsCtrl.TIGK.upCtrl.GOCC$Overlap
enriched.H2O2vsCtrl.TIGK.upCtrl.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2vsCtrl.TIGK.upCtrl.GOCC, aes(x=enriched.H2O2vsCtrl.TIGK.upCtrl.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2vsCtrl.TIGK.upCtrl.GOCC$Adjusted.P.value, size=(enriched.H2O2vsCtrl.TIGK.upCtrl.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/H2O2 Treatment vs Ctrl - TIGK Dotplots/Downregulated after H2O2 treatment/GO CC_DEGs Down after H2O2.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.H2O2vsCtrl.TIGK.upCtrl.Reactome<-as.data.frame(enriched.H2O2vsCtrl.TIGK.upCtrl$Reactome_2022)[1:10,]
frac <- enriched.H2O2vsCtrl.TIGK.upCtrl.Reactome$Overlap
enriched.H2O2vsCtrl.TIGK.upCtrl.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2vsCtrl.TIGK.upCtrl.Reactome, aes(x=enriched.H2O2vsCtrl.TIGK.upCtrl.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2vsCtrl.TIGK.upCtrl.Reactome$Adjusted.P.value, size=(enriched.H2O2vsCtrl.TIGK.upCtrl.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment 1_cutoff1 DEGs/H2O2 Treatment vs Ctrl - TIGK Dotplots/Downregulated after H2O2 treatment/Reactome_DEGs Down after H2O2.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#### Pulling out the genes related to ROS production and Antioxidants ####
human.antioxidants<-read.csv("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/Antioxidant.csv")
human.Prooxidants<-read.csv("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/ProOxidant.csv")

# Antioxidants (AOs) - HaCaT vs TIGK (Baseline)####
Ctrl.AOs.HvsT<-subset(HvsT.Ctrl, symbol %in% human.antioxidants$Human.Antioxidant)
nrow(Ctrl.AOs.HvsT)

mat.Ctrl.AOs.HvsT<-counts(dds.HvsT.Ctrl, normalized = T)[Ctrl.AOs.HvsT$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.Ctrl.AOs.HvsT.z<-t(apply(mat.Ctrl.AOs.HvsT, 1, scale))
colnames(mat.Ctrl.AOs.HvsT.z)<-colnames(mat.Ctrl.AOs.HvsT)
col.order <- c("Hctrl1","Hctrl2","Hctrl3","Tctrl1","Tctrl2","Tctrl3")
mat.Ctrl.AOs.HvsT.z<-mat.Ctrl.AOs.HvsT.z[,col.order]
rownames(mat.Ctrl.AOs.HvsT.z)
p1<-pheatmap(mat.Ctrl.AOs.HvsT.z, labels_row = Ctrl.AOs.HvsT$symbol, 
             cluster_cols = FALSE,
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Antioxidants/Baseline/Antioxidants_HaCaT vs TIGK.Baseline.png",
    width = 2400,
    height = 2400,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(Ctrl.AOs.HvsT,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Antioxidant List/AOs.HaCaT vs TIGK.Baseline.csv")

# Antioxidants (AOs) - upregulated in HaCaT (Baseline)
Ctrl.AOs.HaCaT<-subset(HvsT.Ctrl.upHaCaT, symbol %in% human.antioxidants$Human.Antioxidant)
nrow(Ctrl.AOs.HaCaT)

mat.Ctrl.AOs.HaCaT<-counts(dds.HvsT.Ctrl, normalized = T)[Ctrl.AOs.HaCaT$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.Ctrl.AOs.HaCaT.z<-t(apply(mat.Ctrl.AOs.HaCaT, 1, scale))
colnames(mat.Ctrl.AOs.HaCaT.z)<-colnames(mat.Ctrl.AOs.HaCaT)
rownames(mat.Ctrl.AOs.HaCaT.z)
col.order <- c("Hctrl1","Hctrl2","Hctrl3","Tctrl1","Tctrl2","Tctrl3")
mat.Ctrl.AOs.HaCaT.z<-mat.Ctrl.AOs.HaCaT.z[,col.order]

p1<-pheatmap(mat.Ctrl.AOs.HaCaT.z, labels_row = Ctrl.AOs.HaCaT$symbol,
             cluster_cols = FALSE,
         cellwidth = 60,
         show_colnames = T,
         fontsize_col = 20,
         fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Antioxidants/Baseline/Antioxidants up in HaCaT_Baseline.png",
    width = 2400,
    height = 2400,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(Ctrl.AOs.HaCaT,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Antioxidant List/AOs.Upregulated in HaCaT at Baseline.csv")

# Antioxidants (AOs) - upregulated in TIGK (Baseline)
Ctrl.AOs.TIGK<-subset(HvsT.Ctrl.upTIGK, symbol %in% human.antioxidants$Human.Antioxidant)
nrow(Ctrl.AOs.TIGK)

mat.Ctrl.AOs.TIGK<-counts(dds.HvsT.Ctrl, normalized = T)[Ctrl.AOs.TIGK$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.Ctrl.AOs.TIGK.z<-t(apply(mat.Ctrl.AOs.TIGK, 1, scale))
colnames(mat.Ctrl.AOs.TIGK.z)<-colnames(mat.Ctrl.AOs.TIGK)
rownames(mat.Ctrl.AOs.TIGK.z)
col.order <- c("Hctrl1","Hctrl2","Hctrl3","Tctrl1","Tctrl2","Tctrl3")
mat.Ctrl.AOs.TIGK.z<-mat.Ctrl.AOs.TIGK.z[,col.order]
p1<-pheatmap(mat.Ctrl.AOs.TIGK.z, labels_row = Ctrl.AOs.TIGK$symbol, 
             cluster_cols = FALSE,
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Antioxidants/Baseline/Antioxidants up in TIGK_Baseline.png",
    width = 2400,
    height = 2400,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(Ctrl.AOs.TIGK,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Antioxidant List/AOs.Upregulated in TIGK at Baseline.csv")

# Antioxidants (AOs) - HaCaT vs TIGK: H2O2 Treatment####
H2O2treatment.AOs<-subset(HvsT.H2O2, symbol %in% human.antioxidants$Human.Antioxidant)
nrow(H2O2treatment.AOs)

mat.H2O2treatment.AOs<-counts(dds.HvsT.H2O2, normalized = T)[H2O2treatment.AOs$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.H2O2treatment.AOs.z<-t(apply(mat.H2O2treatment.AOs, 1, scale))
colnames(mat.H2O2treatment.AOs.z)<-colnames(mat.H2O2treatment.AOs)
rownames(mat.H2O2treatment.AOs.z)
col.order <- c("Hhp1","Hhp2","Hhp3","Thp1","Thp2","Thp3")
mat.H2O2treatment.AOs.z<-mat.H2O2treatment.AOs.z[,col.order]
H2O2treatment.AOs <- H2O2treatment.AOs %>% filter(!(H2O2treatment.AOs$X == "ENSG00000170846"))
p1<-pheatmap(mat.H2O2treatment.AOs.z, labels_row = H2O2treatment.AOs$symbol, 
             cluster_cols = FALSE,
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Antioxidants/H2O2 Treated/Antioxidants HaCaT vs TIGK_H2O2 Treatment.png",
    width = 2400,
    height = 2400,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(H2O2treatment.AOs,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Antioxidant List/AOs.HaCaT vs TIGK after H2O2 Treatment.csv")

# Antioxidants (AOs) - upregulated in HaCaT after H2O2 Treatment
H2O2treatment.AOs.HaCaT<-subset(HvsT.H2O2.upHaCaT, symbol %in% human.antioxidants$Human.Antioxidant)
nrow(H2O2treatment.AOs.HaCaT)

mat.H2O2treatment.AOs.HaCaT<-counts(dds.HvsT.H2O2, normalized = T)[H2O2treatment.AOs.HaCaT$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.H2O2treatment.AOs.HaCaT.z<-t(apply(mat.H2O2treatment.AOs.HaCaT, 1, scale))
colnames(mat.H2O2treatment.AOs.HaCaT.z)<-colnames(mat.H2O2treatment.AOs.HaCaT)
rownames(mat.H2O2treatment.AOs.HaCaT.z)
col.order <- c("Hhp1","Hhp2","Hhp3","Thp1","Thp2","Thp3")
mat.H2O2treatment.AOs.HaCaT.z<-mat.H2O2treatment.AOs.HaCaT.z[,col.order]
H2O2treatment.AOs.HaCaT <- H2O2treatment.AOs.HaCaT %>% filter(!(H2O2treatment.AOs.HaCaT$X == "ENSG00000170846"))
p1<-pheatmap(mat.H2O2treatment.AOs.HaCaT.z, labels_row = H2O2treatment.AOs.HaCaT$symbol, 
             cluster_cols = FALSE, 
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Antioxidants/H2O2 Treated/Antioxidants up in HaCaT_H2O2 Treatment.png",
    width = 2400,
    height = 2400,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(H2O2treatment.AOs.HaCaT,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Antioxidant List/AOs.Upregulated in HaCaT after H2O2 Treatment.csv")

# Antioxidants (AOs) - upregulated in TIGK after H2O2 Treatment
H2O2treatment.AOs.TIGK<-subset(HvsT.H2O2.upTIGK, symbol %in% human.antioxidants$Human.Antioxidant)
nrow(H2O2treatment.AOs.TIGK)

mat.H2O2treatment.AOs.TIGK<-counts(dds.HvsT.H2O2, normalized = T)[H2O2treatment.AOs.TIGK$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.H2O2treatment.AOs.TIGK.z<-t(apply(mat.H2O2treatment.AOs.TIGK, 1, scale))
colnames(mat.H2O2treatment.AOs.TIGK.z)<-colnames(mat.H2O2treatment.AOs.TIGK)
rownames(mat.H2O2treatment.AOs.TIGK.z)
col.order <- c("Hhp1","Hhp2","Hhp3","Thp1","Thp2","Thp3")
mat.H2O2treatment.AOs.TIGK.z<-mat.H2O2treatment.AOs.TIGK.z[,col.order]
H2O2treatment.AOs.TIGK <- H2O2treatment.AOs.TIGK %>% filter(!(H2O2treatment.AOs.TIGK$X == "ENSG00000170846"))
p1<-pheatmap(mat.H2O2treatment.AOs.TIGK.z, labels_row = H2O2treatment.AOs.TIGK$symbol, 
             cluster_cols = FALSE, 
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Antioxidants/H2O2 Treated/Antioxidants up in TIGK_H2O2 Treatment.png",
    width = 2400,
    height = 2400,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(H2O2treatment.AOs.TIGK,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Antioxidant List/AOs.Upregulated in TIGK after H2O2 Treatment.csv")

# Antioxidants (AOs) - HaCaT: H2O2 Treatment vs Baseline####
AOs.H2O2vsCtrl.HaCaT<-subset(H2O2vsCtrl.HaCaT, symbol %in% human.antioxidants$Human.Antioxidant)
nrow(AOs.H2O2vsCtrl.HaCaT)

mat.AOs.H2O2vsCtrl.HaCaT<-counts(dds.H2O2vsCtrl.HaCaT, normalized = T)[AOs.H2O2vsCtrl.HaCaT$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.AOs.H2O2vsCtrl.HaCaT.z<-t(apply(mat.AOs.H2O2vsCtrl.HaCaT, 1, scale))
colnames(mat.AOs.H2O2vsCtrl.HaCaT.z)<-colnames(mat.AOs.H2O2vsCtrl.HaCaT)
rownames(mat.AOs.H2O2vsCtrl.HaCaT.z)
p1<-pheatmap(mat.AOs.H2O2vsCtrl.HaCaT.z, labels_row = AOs.H2O2vsCtrl.HaCaT$symbol, 
             cluster_cols = FALSE,
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Antioxidants/HaCaT_AOs vs Baseline/Antioxidants_H2O2 treatment vs control_HaCaT.png",
    width = 2400,
    height = 2400,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(AOs.H2O2vsCtrl.HaCaT,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Antioxidant List/AOs.HaCaT_H2O2 vs Ctrl.csv")

# Antioxidants (AOs) - upregulated in HaCaT after treatment
AOs.H2O2vsCtrl.HaCaT.upH2O2<-subset(H2O2vsCtrl.HaCaT.upH2O2, symbol %in% human.antioxidants$Human.Antioxidant)
nrow(AOs.H2O2vsCtrl.HaCaT.upH2O2)

mat.AOs.H2O2vsCtrl.HaCaT.upH2O2<-counts(dds.H2O2vsCtrl.HaCaT, normalized = T)[AOs.H2O2vsCtrl.HaCaT.upH2O2$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.AOs.H2O2vsCtrl.HaCaT.upH2O2.z<-t(apply(mat.AOs.H2O2vsCtrl.HaCaT.upH2O2, 1, scale))
colnames(mat.AOs.H2O2vsCtrl.HaCaT.upH2O2.z)<-colnames(mat.AOs.H2O2vsCtrl.HaCaT.upH2O2)
rownames(mat.AOs.H2O2vsCtrl.HaCaT.upH2O2.z)
p1<-pheatmap(mat.AOs.H2O2vsCtrl.HaCaT.upH2O2.z, labels_row = AOs.H2O2vsCtrl.HaCaT.upH2O2$symbol, 
             cluster_cols = FALSE, 
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Antioxidants/HaCaT_AOs vs Baseline/Antioxidants_upregulated after H2O2 treatment_HaCaT.png",
    width = 2400,
    height = 2400,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(AOs.H2O2vsCtrl.HaCaT.upH2O2,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Antioxidant List/AOs.upregulated after H2O2_HaCaT.csv")

# Antioxidants (AOs) - downregulated in HaCaT after treatment
AOs.H2O2vsCtrl.HaCaT.downH2O2<-subset(H2O2vsCtrl.HaCaT.upCtrl, symbol %in% human.antioxidants$Human.Antioxidant)
nrow(AOs.H2O2vsCtrl.HaCaT.downH2O2)

mat.AOs.H2O2vsCtrl.HaCaT.downH2O2<-counts(dds.H2O2vsCtrl.HaCaT, normalized = T)[AOs.H2O2vsCtrl.HaCaT.downH2O2$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.AOs.H2O2vsCtrl.HaCaT.downH2O2.z<-t(apply(mat.AOs.H2O2vsCtrl.HaCaT.downH2O2, 1, scale))
colnames(mat.AOs.H2O2vsCtrl.HaCaT.downH2O2.z)<-colnames(mat.AOs.H2O2vsCtrl.HaCaT.downH2O2)
rownames(mat.AOs.H2O2vsCtrl.HaCaT.downH2O2.z)
p1<-pheatmap(mat.AOs.H2O2vsCtrl.HaCaT.downH2O2.z, labels_row = AOs.H2O2vsCtrl.HaCaT.downH2O2$symbol, 
             cluster_cols = FALSE, 
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Antioxidants/HaCaT_AOs vs Baseline/Antioxidants_downregulated after H2O2 treatment_HaCaT.png",
    width = 2400,
    height = 2400,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(AOs.H2O2vsCtrl.HaCaT.downH2O2,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Antioxidant List/AOs.downregulated after H2O2_HaCaT.csv")


# Antioxidants (AOs) - TIGK: H2O2 Treatment vs Baseline####
AOs.H2O2vsCtrl.TIGK<-subset(H2O2vsCtrl.TIGK, symbol %in% human.antioxidants$Human.Antioxidant)
nrow(AOs.H2O2vsCtrl.TIGK)

mat.AOs.H2O2vsCtrl.TIGK<-counts(dds.H2O2vsCtrl.TIGK, normalized = T)[AOs.H2O2vsCtrl.TIGK$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.AOs.H2O2vsCtrl.TIGK.z<-t(apply(mat.AOs.H2O2vsCtrl.TIGK, 1, scale))
colnames(mat.AOs.H2O2vsCtrl.TIGK.z)<-colnames(mat.AOs.H2O2vsCtrl.TIGK)
rownames(mat.AOs.H2O2vsCtrl.TIGK.z)
p1<-pheatmap(mat.AOs.H2O2vsCtrl.TIGK.z, labels_row = AOs.H2O2vsCtrl.TIGK$symbol, 
             cluster_cols = FALSE,
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Antioxidants/TIGK_AOs vs Baseline/Antioxidants_H2O2 treatment vs control_TIGK.png",
    width = 2400,
    height = 2400,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(AOs.H2O2vsCtrl.TIGK,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Antioxidant List/AOs.TIGK_H2O2 vs Ctrl.csv")

# Antioxidants (AOs) - upregulated in TIGK after treatment
AOs.H2O2vsCtrl.TIGK.upH2O2<-subset(H2O2vsCtrl.TIGK.upH2O2, symbol %in% human.antioxidants$Human.Antioxidant)
nrow(AOs.H2O2vsCtrl.TIGK.upH2O2)

mat.AOs.H2O2vsCtrl.TIGK.upH2O2<-counts(dds.H2O2vsCtrl.TIGK, normalized = T)[AOs.H2O2vsCtrl.TIGK.upH2O2$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.AOs.H2O2vsCtrl.TIGK.upH2O2.z<-t(apply(mat.AOs.H2O2vsCtrl.TIGK.upH2O2, 1, scale))
colnames(mat.AOs.H2O2vsCtrl.TIGK.upH2O2.z)<-colnames(mat.AOs.H2O2vsCtrl.TIGK.upH2O2)
rownames(mat.AOs.H2O2vsCtrl.TIGK.upH2O2.z)
p1<-pheatmap(mat.AOs.H2O2vsCtrl.TIGK.upH2O2.z, labels_row = AOs.H2O2vsCtrl.TIGK.upH2O2$symbol, 
             cluster_cols = FALSE,
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Antioxidants/TIGK_AOs vs Baseline/Antioxidants_upregulated after H2O2 treatment_TIGK.png",
    width = 2400,
    height = 2400,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(AOs.H2O2vsCtrl.TIGK.upH2O2,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Antioxidant List/AOs.upregulated after H2O2_TIGK.csv")

# Antioxidants (AOs) - downregulated in TIGK after treatment
AOs.H2O2vsCtrl.TIGK.downH2O2<-subset(H2O2vsCtrl.TIGK.upCtrl, symbol %in% human.antioxidants$Human.Antioxidant)
nrow(AOs.H2O2vsCtrl.TIGK.downH2O2)

mat.AOs.H2O2vsCtrl.TIGK.downH2O2<-counts(dds.H2O2vsCtrl.TIGK, normalized = T)[AOs.H2O2vsCtrl.TIGK.downH2O2$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.AOs.H2O2vsCtrl.TIGK.downH2O2.z<-t(apply(mat.AOs.H2O2vsCtrl.TIGK.downH2O2, 1, scale))
colnames(mat.AOs.H2O2vsCtrl.TIGK.downH2O2.z)<-colnames(mat.AOs.H2O2vsCtrl.TIGK.downH2O2)
rownames(mat.AOs.H2O2vsCtrl.TIGK.downH2O2.z)
p1<-pheatmap(mat.AOs.H2O2vsCtrl.TIGK.downH2O2.z, labels_row = AOs.H2O2vsCtrl.TIGK.downH2O2$symbol, 
             cluster_cols = FALSE,
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Antioxidants/TIGK_AOs vs Baseline/Antioxidants_downregulated after H2O2 treatment_TIGK.png",
    width = 2400,
    height = 2400,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(AOs.H2O2vsCtrl.TIGK.downH2O2,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Antioxidant List/AOs.downregulated after H2O2_TIGK.csv")



# ProOxidants (POs) - HaCaT vs TIGK (Baseline) ####
Ctrl.POs<-subset(HvsT.Ctrl, symbol %in% human.Prooxidants$Human.ProOxidant)
Ctrl.POs <- Ctrl.POs %>% filter(!(Ctrl.POs$X == "ENSG00000170846"))
nrow(Ctrl.POs)

mat.Ctrl.POs<-counts(dds.HvsT.Ctrl, normalized = T)[Ctrl.POs$X,] 
mat.Ctrl.POs.z<-t(apply(mat.Ctrl.POs, 1, scale))
colnames(mat.Ctrl.POs.z)<-colnames(mat.Ctrl.POs)
col.order <- c("Hctrl1","Hctrl2","Hctrl3","Tctrl1","Tctrl2","Tctrl3")
mat.Ctrl.POs.z<-mat.Ctrl.POs.z[,col.order]

p1<-pheatmap(mat.Ctrl.POs.z, labels_row = Ctrl.POs$symbol, 
             cluster_cols = FALSE,
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of ProOxidants/Baseline/ProOxidants_HaCaT vs TIGK_Baseline.png",
    width = 2400,
    height = 2600,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(Ctrl.POs,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/ProOxidants List/POs_HaCaT vs TIGK_aseline.csv")

# ProOxidants (POs) - upregulated in HaCaT (Baseline)
Ctrl.POs.HaCaT<-subset(HvsT.Ctrl.upHaCaT, symbol %in% human.Prooxidants$Human.ProOxidant)
Ctrl.POs.HaCaT <- Ctrl.POs.HaCaT %>% filter(!(Ctrl.POs.HaCaT$X == "ENSG00000170846"))
nrow(Ctrl.POs.HaCaT)

mat.Ctrl.POs.HaCaT<-counts(dds.HvsT.Ctrl, normalized = T)[Ctrl.POs.HaCaT$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.Ctrl.POs.HaCaT.z<-t(apply(mat.Ctrl.POs.HaCaT, 1, scale))
colnames(mat.Ctrl.POs.HaCaT.z)<-colnames(mat.Ctrl.POs.HaCaT)
rownames(mat.Ctrl.POs.HaCaT.z)
col.order <- c("Hctrl1","Hctrl2","Hctrl3","Tctrl1","Tctrl2","Tctrl3")
mat.Ctrl.POs.HaCaT.z<-mat.Ctrl.POs.HaCaT.z[,col.order]
p1<-pheatmap(mat.Ctrl.POs.HaCaT.z, labels_row = Ctrl.POs.HaCaT$symbol, 
             cluster_cols = FALSE, 
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of ProOxidants/Baseline/ProOxidants up in HaCaT_Baseline.png",
    width = 2400,
    height = 2400,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(Ctrl.POs.HaCaT,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/ProOxidants List/POs.Upregulated in HaCaT at Baseline.csv")

# ProOxidants (POs) - upregulated in TIGK (Baseline)
Ctrl.POs.TIGK<-subset(HvsT.Ctrl.upTIGK, symbol %in% human.Prooxidants$Human.ProOxidant)
Ctrl.POs.TIGK <- Ctrl.POs.TIGK %>% filter(!(Ctrl.POs.TIGK$X == "ENSG00000170846"))
nrow(Ctrl.POs.TIGK)

mat.Ctrl.POs.TIGK<-counts(dds.HvsT.Ctrl, normalized = T)[Ctrl.POs.TIGK$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.Ctrl.POs.TIGK.z<-t(apply(mat.Ctrl.POs.TIGK, 1, scale))
colnames(mat.Ctrl.POs.TIGK.z)<-colnames(mat.Ctrl.POs.TIGK)
col.order <- c("Hctrl1","Hctrl2","Hctrl3","Tctrl1","Tctrl2","Tctrl3")
mat.Ctrl.POs.TIGK.z<-mat.Ctrl.POs.TIGK.z[,col.order]
p1<-pheatmap(mat.Ctrl.POs.TIGK.z, labels_row = Ctrl.POs.TIGK$symbol, 
             cluster_cols = FALSE, 
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of ProOxidants/Baseline/ProOxidants up in TIGK_Baseline.png",
    width = 2400,
    height = 2400,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(Ctrl.POs.TIGK,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/ProOxidants List/POs.Upregulated in TIGK at Baseline.csv")


# ProOxidants (POs) - HaCaT vs TIGK: H2O2 Treatment####
H2O2treatment.POs<-subset(HvsT.H2O2, symbol %in% human.Prooxidants$Human.ProOxidant)
nrow(H2O2treatment.POs)
H2O2treatment.POs <- H2O2treatment.POs %>% filter(!(H2O2treatment.POs$X == "ENSG00000170846"))

mat.H2O2treatment.POs<-counts(dds.HvsT.H2O2, normalized = T)[H2O2treatment.POs$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.H2O2treatment.POs.z<-t(apply(mat.H2O2treatment.POs, 1, scale))
colnames(mat.H2O2treatment.POs.z)<-colnames(mat.H2O2treatment.POs)
rownames(mat.H2O2treatment.POs.z)
col.order <- c("Hhp1","Hhp2","Hhp3","Thp1","Thp2","Thp3")
mat.H2O2treatment.POs.z<-mat.H2O2treatment.POs.z[,col.order]
p1<-pheatmap(mat.H2O2treatment.POs.z, labels_row = H2O2treatment.POs$symbol, 
             cellwidth = 60, cluster_cols = FALSE,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of ProOxidants/H2O2 Treated/Prooxidants HaCaT vs TIGK_H2O2 Treatment.png",
    width = 2400,
    height = 2400,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(H2O2treatment.POs,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/ProOxidants List/POs.HaCaT vs TIGK after H2O2 Treatment.csv")

# ProOxidants (POs) - upregulated in HaCaT after H2O2 Treatment
H2O2treatment.POs.HaCaT<-subset(HvsT.H2O2.upHaCaT, symbol %in% human.Prooxidants$Human.ProOxidant)
nrow(H2O2treatment.POs.HaCaT)
H2O2treatment.POs.HaCaT <- H2O2treatment.POs.HaCaT %>% filter(!(H2O2treatment.POs.HaCaT$X == "ENSG00000170846"))

mat.H2O2treatment.POs.HaCaT<-counts(dds.HvsT.H2O2, normalized = T)[H2O2treatment.POs.HaCaT$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.H2O2treatment.POs.HaCaT.z<-t(apply(mat.H2O2treatment.POs.HaCaT, 1, scale))
colnames(mat.H2O2treatment.POs.HaCaT.z)<-colnames(mat.H2O2treatment.POs.HaCaT)
rownames(mat.H2O2treatment.POs.HaCaT.z)
col.order <- c("Hhp1","Hhp2","Hhp3","Thp1","Thp2","Thp3")
mat.H2O2treatment.POs.HaCaT.z<-mat.H2O2treatment.POs.HaCaT.z[,col.order]
p1<-pheatmap(mat.H2O2treatment.POs.HaCaT.z, labels_row = H2O2treatment.POs.HaCaT$symbol, 
             cellwidth = 60, cluster_cols = FALSE,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of ProOxidants/H2O2 Treated/ProOxidants up in HaCaT_H2O2 Treatment.png",
    width = 2400,
    height = 2400,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(H2O2treatment.POs.HaCaT,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/ProOxidants List/POs.Upregulated in HaCaT after H2O2 Treatment.csv")

# ProOxidants (POs) - upregulated in TIGK after H2O2 Treatment
H2O2treatment.POs.TIGK<-subset(HvsT.H2O2.upTIGK, symbol %in% human.Prooxidants$Human.ProOxidant)
nrow(H2O2treatment.POs.TIGK)
H2O2treatment.POs.TIGK <- H2O2treatment.POs.TIGK %>% filter(!(H2O2treatment.POs.TIGK$X == "ENSG00000170846"))

mat.H2O2treatment.POs.TIGK<-counts(dds.HvsT.H2O2, normalized = T)[H2O2treatment.POs.TIGK$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.H2O2treatment.POs.TIGK.z<-t(apply(mat.H2O2treatment.POs.TIGK, 1, scale))
colnames(mat.H2O2treatment.POs.TIGK.z)<-colnames(mat.H2O2treatment.POs.TIGK)
rownames(mat.H2O2treatment.POs.TIGK.z)
col.order <- c("Hhp1","Hhp2","Hhp3","Thp1","Thp2","Thp3")
mat.H2O2treatment.POs.TIGK.z<-mat.H2O2treatment.POs.TIGK.z[,col.order]
p1<-pheatmap(mat.H2O2treatment.POs.TIGK.z, labels_row = H2O2treatment.POs.TIGK$symbol, 
             cellwidth = 60, cluster_cols = FALSE,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of ProOxidants/H2O2 Treated/ProOxidants up in TIGK_H2O2 Treatment.png",
    width = 2400,
    height = 2400,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(H2O2treatment.POs.TIGK,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/ProOxidants List/POs.Upregulated in TIGK after H2O2 Treatment.csv")



# ProOxidants (POs) - HaCaT: H2O2 Treatment vs Baseline####
POs.H2O2vsCtrl.HaCaT<-subset(H2O2vsCtrl.HaCaT, symbol %in% human.Prooxidants$Human.ProOxidant)
nrow(POs.H2O2vsCtrl.HaCaT)

POs.H2O2vsCtrl.HaCaT <- POs.H2O2vsCtrl.HaCaT %>% filter(!(POs.H2O2vsCtrl.HaCaT$X == "ENSG00000278384"))
mat.POs.H2O2vsCtrl.HaCaT<-counts(dds.H2O2vsCtrl.HaCaT, normalized = T)[POs.H2O2vsCtrl.HaCaT$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.POs.H2O2vsCtrl.HaCaT.z<-t(apply(mat.POs.H2O2vsCtrl.HaCaT, 1, scale))
colnames(mat.POs.H2O2vsCtrl.HaCaT.z)<-colnames(mat.POs.H2O2vsCtrl.HaCaT)
rownames(mat.POs.H2O2vsCtrl.HaCaT.z)
p1<-pheatmap(mat.POs.H2O2vsCtrl.HaCaT.z, labels_row = POs.H2O2vsCtrl.HaCaT$symbol, 
             cellwidth = 60, cluster_cols = FALSE,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of ProOxidants/HaCaT_POs vs Baseline/ProOxidants_H2O2 treatment vs Control_HaCaT.png",
    width = 2400,
    height = 2400,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(POs.H2O2vsCtrl.HaCaT,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/ProOxidants List/POs.HaCaT_H2O2 vs Ctrl.csv")

# ProOxidants (POs) - upregulated in HaCaT after treatment
POs.H2O2vsCtrl.HaCaT.upH2O2<-subset(H2O2vsCtrl.HaCaT.upH2O2, symbol %in% human.Prooxidants$Human.ProOxidant)
nrow(POs.H2O2vsCtrl.HaCaT.upH2O2)

mat.POs.H2O2vsCtrl.HaCaT.upH2O2<-counts(dds.H2O2vsCtrl.HaCaT, normalized = T)[POs.H2O2vsCtrl.HaCaT.upH2O2$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.POs.H2O2vsCtrl.HaCaT.upH2O2.z<-t(apply(mat.POs.H2O2vsCtrl.HaCaT.upH2O2, 1, scale))
colnames(mat.POs.H2O2vsCtrl.HaCaT.upH2O2.z)<-colnames(mat.POs.H2O2vsCtrl.HaCaT.upH2O2)
rownames(mat.POs.H2O2vsCtrl.HaCaT.upH2O2.z)
p1<-pheatmap(mat.POs.H2O2vsCtrl.HaCaT.upH2O2.z, labels_row = POs.H2O2vsCtrl.HaCaT.upH2O2$symbol, 
             cellwidth = 60, cluster_cols = FALSE,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of ProOxidants/HaCaT_POs vs Baseline/ProOxidants_upregulated after H2O2 treatment_HaCaT.png",
    width = 2400,
    height = 2400,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(POs.H2O2vsCtrl.HaCaT.upH2O2,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/ProOxidants List/POs.upregulated after H2O2_HaCaT.csv")

# ProOxidants (POs) - downregulated in HaCaT after treatment
POs.H2O2vsCtrl.HaCaT.downH2O2<-subset(H2O2vsCtrl.HaCaT.upCtrl, symbol %in% human.Prooxidants$Human.ProOxidant)
nrow(POs.H2O2vsCtrl.HaCaT.downH2O2)

mat.POs.H2O2vsCtrl.HaCaT.downH2O2<-counts(dds.H2O2vsCtrl.HaCaT, normalized = T)[POs.H2O2vsCtrl.HaCaT.downH2O2$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.POs.H2O2vsCtrl.HaCaT.downH2O2.z<-t(apply(mat.POs.H2O2vsCtrl.HaCaT.downH2O2, 1, scale))
colnames(mat.POs.H2O2vsCtrl.HaCaT.downH2O2.z)<-colnames(mat.POs.H2O2vsCtrl.HaCaT.downH2O2)
rownames(mat.POs.H2O2vsCtrl.HaCaT.downH2O2.z)
p1<-pheatmap(mat.POs.H2O2vsCtrl.HaCaT.downH2O2.z, labels_row = POs.H2O2vsCtrl.HaCaT.downH2O2$symbol, 
             cellwidth = 60, cluster_cols = FALSE,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of ProOxidants/HaCaT_POs vs Baseline/ProOxidants_downregulated after H2O2 treatment_HaCaT.png",
    width = 2400,
    height = 2400,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(POs.H2O2vsCtrl.HaCaT.downH2O2,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/ProOxidants List/POs.downregulated after H2O2_HaCaT.csv")

# ProOxidants (POs) - TIGK: H2O2 Treatment vs Baseline####
POs.H2O2vsCtrl.TIGK<-subset(H2O2vsCtrl.TIGK, symbol %in% human.Prooxidants$Human.ProOxidant)
nrow(POs.H2O2vsCtrl.TIGK)

POs.H2O2vsCtrl.TIGK <- POs.H2O2vsCtrl.TIGK %>% filter(!(POs.H2O2vsCtrl.TIGK$X == "ENSG00000170846"))
mat.POs.H2O2vsCtrl.TIGK<-counts(dds.H2O2vsCtrl.TIGK, normalized = T)[POs.H2O2vsCtrl.TIGK$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.POs.H2O2vsCtrl.TIGK.z<-t(apply(mat.POs.H2O2vsCtrl.TIGK, 1, scale))
colnames(mat.POs.H2O2vsCtrl.TIGK.z)<-colnames(mat.POs.H2O2vsCtrl.TIGK)
rownames(mat.POs.H2O2vsCtrl.TIGK.z)
p1<-pheatmap(mat.POs.H2O2vsCtrl.TIGK.z, labels_row = POs.H2O2vsCtrl.TIGK$symbol, 
             cellwidth = 60, cluster_cols = FALSE,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of ProOxidants/TIGK_POs vs Baseline/ProOxidants_H2O2 treatment vs control_TIGK.png",
    width = 2400,
    height = 2400,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(POs.H2O2vsCtrl.TIGK,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/ProOxidants List/POs.TIGK_H2O2 vs Ctrl.csv")

# ProOxidants (POs) - upregulated in TIGK after treatment
POs.H2O2vsCtrl.TIGK.upH2O2<-subset(H2O2vsCtrl.TIGK.upH2O2, symbol %in% human.Prooxidants$Human.ProOxidant)
nrow(POs.H2O2vsCtrl.TIGK.upH2O2)

mat.POs.H2O2vsCtrl.TIGK.upH2O2<-counts(dds.H2O2vsCtrl.TIGK, normalized = T)[POs.H2O2vsCtrl.TIGK.upH2O2$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.POs.H2O2vsCtrl.TIGK.upH2O2.z<-t(apply(mat.POs.H2O2vsCtrl.TIGK.upH2O2, 1, scale))
colnames(mat.POs.H2O2vsCtrl.TIGK.upH2O2.z)<-colnames(mat.POs.H2O2vsCtrl.TIGK.upH2O2)
rownames(mat.POs.H2O2vsCtrl.TIGK.upH2O2.z)
p1<-pheatmap(mat.POs.H2O2vsCtrl.TIGK.upH2O2.z, labels_row = POs.H2O2vsCtrl.TIGK.upH2O2$symbol, 
             cellwidth = 60, cluster_cols = FALSE,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of ProOxidants/TIGK_POs vs Baseline/ProOxidants_upregulated after H2O2 treatment_TIGK.png",
    width = 2400,
    height = 2400,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(POs.H2O2vsCtrl.TIGK.upH2O2,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/ProOxidants List/POs.upregulated after H2O2_TIGK.csv")

# ProOxidants (POs) - downregulated in TIGK after treatment
POs.H2O2vsCtrl.TIGK.downH2O2<-subset(H2O2vsCtrl.TIGK.upCtrl, symbol %in% human.Prooxidants$Human.ProOxidant)
nrow(POs.H2O2vsCtrl.TIGK.downH2O2)

mat.POs.H2O2vsCtrl.TIGK.downH2O2<-counts(dds.H2O2vsCtrl.TIGK, normalized = T)[POs.H2O2vsCtrl.TIGK.downH2O2$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.POs.H2O2vsCtrl.TIGK.downH2O2.z<-t(apply(mat.POs.H2O2vsCtrl.TIGK.downH2O2, 1, scale))
colnames(mat.POs.H2O2vsCtrl.TIGK.downH2O2.z)<-colnames(mat.POs.H2O2vsCtrl.TIGK.downH2O2)
rownames(mat.POs.H2O2vsCtrl.TIGK.downH2O2.z)
p1<-pheatmap(mat.POs.H2O2vsCtrl.TIGK.downH2O2.z, labels_row = POs.H2O2vsCtrl.TIGK.downH2O2$symbol, 
             cellwidth = 60, cluster_cols = FALSE,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of ProOxidants/TIGK_POs vs Baseline/ProOxidants_downregulated after H2O2 treatment_TIGK.png",
    width = 2400,
    height = 2400,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(POs.H2O2vsCtrl.TIGK.downH2O2,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/ProOxidants List/POs.downregulated after H2O2_TIGK.csv")


#### Enrichment for the antioxidant genes ####
#Enrichment of HvsT Control: Antioxidants upregulated in HaCaT relative to TIGK ####
enriched.Ctrl.AOs.HaCaT <- enrichr(Ctrl.AOs.HaCaT$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up HaCaT")
addWorksheet(Enrichments, "CC Up HaCaT")
addWorksheet(Enrichments, "MF Up HaCaT")
addWorksheet(Enrichments, "Reactome Up HaCaT")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up HaCaT", x = as.data.frame((as.data.frame(enriched.Ctrl.AOs.HaCaT$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up HaCaT", x = as.data.frame((as.data.frame(enriched.Ctrl.AOs.HaCaT$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up HaCaT", x = as.data.frame((as.data.frame(enriched.Ctrl.AOs.HaCaT$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up HaCaT", x = as.data.frame((as.data.frame(enriched.Ctrl.AOs.HaCaT$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HvsT_Control/HvsT_Ctrl_AOs up in HaCaT.xlsx")

#Dotplots for the enrichment
#GO BP
enriched.Ctrl.AOs.HaCaT.GOBP<-as.data.frame(enriched.Ctrl.AOs.HaCaT$GO_Biological_Process_2023)[1:10,]
frac <- enriched.Ctrl.AOs.HaCaT.GOBP$Overlap
enriched.Ctrl.AOs.HaCaT.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.AOs.HaCaT.GOBP, aes(x=enriched.Ctrl.AOs.HaCaT.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.AOs.HaCaT.GOBP$Adjusted.P.value, size=(enriched.Ctrl.AOs.HaCaT.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HvsT_Control/HvsT_Ctrl_AOs up in HaCaT_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.Ctrl.AOs.HaCaT.GOMF<-as.data.frame(enriched.Ctrl.AOs.HaCaT$GO_Molecular_Function_2023)[1:8,]
frac <- enriched.Ctrl.AOs.HaCaT.GOMF$Overlap
enriched.Ctrl.AOs.HaCaT.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.AOs.HaCaT.GOMF, aes(x=enriched.Ctrl.AOs.HaCaT.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.AOs.HaCaT.GOMF$Adjusted.P.value, size=(enriched.Ctrl.AOs.HaCaT.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HvsT_Control/HvsT_Ctrl_AOs up in HaCaT_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.Ctrl.AOs.HaCaT.GOCC<-as.data.frame(enriched.Ctrl.AOs.HaCaT$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.Ctrl.AOs.HaCaT.GOCC$Overlap
enriched.Ctrl.AOs.HaCaT.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.AOs.HaCaT.GOCC, aes(x=enriched.Ctrl.AOs.HaCaT.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.AOs.HaCaT.GOCC$Adjusted.P.value, size=(enriched.Ctrl.AOs.HaCaT.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HvsT_Control/HvsT_Ctrl_AOs up in HaCaT_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.Ctrl.AOs.HaCaT.Reactome<-as.data.frame(enriched.Ctrl.AOs.HaCaT$Reactome_2022)[1:10,]
frac <- enriched.Ctrl.AOs.HaCaT.Reactome$Overlap
enriched.Ctrl.AOs.HaCaT.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.AOs.HaCaT.Reactome, aes(x=enriched.Ctrl.AOs.HaCaT.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.AOs.HaCaT.Reactome$Adjusted.P.value, size=(enriched.Ctrl.AOs.HaCaT.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HvsT_Control/HvsT_Ctrl_AOs up in HaCaT_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()


##Enrichment of HvsT Control: Antioxidants upregulated in TIGK relative to HaCaT ####
enriched.Ctrl.AOs.TIGK <- enrichr(Ctrl.AOs.TIGK$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up TIGK")
addWorksheet(Enrichments, "CC Up TIGK")
addWorksheet(Enrichments, "MF Up TIGK")
addWorksheet(Enrichments, "Reactome Up TIGK")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up TIGK", x = as.data.frame((as.data.frame(enriched.Ctrl.AOs.TIGK$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up TIGK", x = as.data.frame((as.data.frame(enriched.Ctrl.AOs.TIGK$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up TIGK", x = as.data.frame((as.data.frame(enriched.Ctrl.AOs.TIGK$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up TIGK", x = as.data.frame((as.data.frame(enriched.Ctrl.AOs.TIGK$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))# Export the file
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HvsT_Control/HvsT_Ctrl_AOs up in TIGK.xlsx")


#GO BP
enriched.Ctrl.AOs.TIGK.GOBP<-as.data.frame(enriched.Ctrl.AOs.TIGK$GO_Biological_Process_2023)[1:10,]
frac <- enriched.Ctrl.AOs.TIGK.GOBP$Overlap
enriched.Ctrl.AOs.TIGK.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.AOs.TIGK.GOBP, aes(x=enriched.Ctrl.AOs.TIGK.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.AOs.TIGK.GOBP$Adjusted.P.value, size=(enriched.Ctrl.AOs.TIGK.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HvsT_Control/HvsT_Ctrl_AOs up in TIGK_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.Ctrl.AOs.TIGK.GOMF<-as.data.frame(enriched.Ctrl.AOs.TIGK$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.Ctrl.AOs.TIGK.GOMF$Overlap
enriched.Ctrl.AOs.TIGK.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.AOs.TIGK.GOMF, aes(x=enriched.Ctrl.AOs.TIGK.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.AOs.TIGK.GOMF$Adjusted.P.value, size=(enriched.Ctrl.AOs.TIGK.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HvsT_Control/HvsT_Ctrl_AOs up in TIGK_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.Ctrl.AOs.TIGK.GOCC<-as.data.frame(enriched.Ctrl.AOs.TIGK$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.Ctrl.AOs.TIGK.GOCC$Overlap
enriched.Ctrl.AOs.TIGK.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.AOs.TIGK.GOCC, aes(x=enriched.Ctrl.AOs.TIGK.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.AOs.TIGK.GOCC$Adjusted.P.value, size=(enriched.Ctrl.AOs.TIGK.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HvsT_Control/HvsT_Ctrl_AOs up in TIGK_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.Ctrl.AOs.TIGK.Reactome<-as.data.frame(enriched.Ctrl.AOs.TIGK$Reactome_2022)[1:10,]
frac <- enriched.Ctrl.AOs.TIGK.Reactome$Overlap
enriched.Ctrl.AOs.TIGK.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.AOs.TIGK.Reactome, aes(x=enriched.Ctrl.AOs.TIGK.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.AOs.TIGK.Reactome$Adjusted.P.value, size=(enriched.Ctrl.AOs.TIGK.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HvsT_Control/HvsT_Ctrl_AOs up in TIGK_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Enrichment of HvsT after H2O2 Treatment: Antioxidants upregulated in HaCaT relative to TIGK ####
enriched.H2O2treatment.AOs.HaCaT <- enrichr(H2O2treatment.AOs.HaCaT$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up HaCaT")
addWorksheet(Enrichments, "CC Up HaCaT")
addWorksheet(Enrichments, "MF Up HaCaT")
addWorksheet(Enrichments, "Reactome Up HaCaT")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up HaCaT", x = as.data.frame((as.data.frame(enriched.H2O2treatment.AOs.HaCaT$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up HaCaT", x = as.data.frame((as.data.frame(enriched.H2O2treatment.AOs.HaCaT$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up HaCaT", x = as.data.frame((as.data.frame(enriched.H2O2treatment.AOs.HaCaT$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up HaCaT", x = as.data.frame((as.data.frame(enriched.H2O2treatment.AOs.HaCaT$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HvsT_H2O2/HvsT_H2O2 Treatment_AOs up in HaCaT.xlsx")

#Dotplots for the enrichment
#GO BP
enriched.H2O2treatment.AOs.HaCaT.GOBP<-as.data.frame(enriched.H2O2treatment.AOs.HaCaT$GO_Biological_Process_2023)[1:10,]
frac <- enriched.H2O2treatment.AOs.HaCaT.GOBP$Overlap
enriched.H2O2treatment.AOs.HaCaT.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.AOs.HaCaT.GOBP, aes(x=enriched.H2O2treatment.AOs.HaCaT.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.AOs.HaCaT.GOBP$Adjusted.P.value, size=(enriched.H2O2treatment.AOs.HaCaT.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HvsT_H2O2/HvsT_H2O2 Treatment_AOs up in HaCaT_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.H2O2treatment.AOs.HaCaT.GOMF<-as.data.frame(enriched.H2O2treatment.AOs.HaCaT$GO_Molecular_Function_2023)[1:8,]
frac <- enriched.H2O2treatment.AOs.HaCaT.GOMF$Overlap
enriched.H2O2treatment.AOs.HaCaT.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.AOs.HaCaT.GOMF, aes(x=enriched.H2O2treatment.AOs.HaCaT.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.AOs.HaCaT.GOMF$Adjusted.P.value, size=(enriched.H2O2treatment.AOs.HaCaT.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HvsT_H2O2/HvsT_H2O2 Treatment_AOs up in HaCaT_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.H2O2treatment.AOs.HaCaT.GOCC<-as.data.frame(enriched.H2O2treatment.AOs.HaCaT$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.H2O2treatment.AOs.HaCaT.GOCC$Overlap
enriched.H2O2treatment.AOs.HaCaT.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.AOs.HaCaT.GOCC, aes(x=enriched.H2O2treatment.AOs.HaCaT.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.AOs.HaCaT.GOCC$Adjusted.P.value, size=(enriched.H2O2treatment.AOs.HaCaT.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HvsT_H2O2/HvsT_H2O2 Treatment_AOs up in HaCaT_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.H2O2treatment.AOs.HaCaT.Reactome<-as.data.frame(enriched.H2O2treatment.AOs.HaCaT$Reactome_2022)[1:10,]
frac <- enriched.H2O2treatment.AOs.HaCaT.Reactome$Overlap
enriched.H2O2treatment.AOs.HaCaT.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.AOs.HaCaT.Reactome, aes(x=enriched.H2O2treatment.AOs.HaCaT.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.AOs.HaCaT.Reactome$Adjusted.P.value, size=(enriched.H2O2treatment.AOs.HaCaT.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HvsT_H2O2/HvsT_H2O2 Treatment_AOs up in HaCaT_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()


##Enrichment of HvsT after H2O2 Treatment: Antioxidants upregulated in TIGK relative to HaCaT ####
enriched.H2O2treatment.AOs.TIGK <- enrichr(H2O2treatment.AOs.TIGK$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up TIGK")
addWorksheet(Enrichments, "CC Up TIGK")
addWorksheet(Enrichments, "MF Up TIGK")
addWorksheet(Enrichments, "Reactome Up TIGK")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up TIGK", x = as.data.frame((as.data.frame(enriched.H2O2treatment.AOs.TIGK$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up TIGK", x = as.data.frame((as.data.frame(enriched.H2O2treatment.AOs.TIGK$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up TIGK", x = as.data.frame((as.data.frame(enriched.H2O2treatment.AOs.TIGK$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up TIGK", x = as.data.frame((as.data.frame(enriched.H2O2treatment.AOs.TIGK$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))# Export the file
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HvsT_H2O2/HvsT_H2O2 Treatment_AOs up in TIGK.xlsx")


#GO BP
enriched.H2O2treatment.AOs.TIGK.GOBP<-as.data.frame(enriched.H2O2treatment.AOs.TIGK$GO_Biological_Process_2023)[1:10,]
frac <- enriched.H2O2treatment.AOs.TIGK.GOBP$Overlap
enriched.H2O2treatment.AOs.TIGK.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.AOs.TIGK.GOBP, aes(x=enriched.H2O2treatment.AOs.TIGK.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.AOs.TIGK.GOBP$Adjusted.P.value, size=(enriched.H2O2treatment.AOs.TIGK.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HvsT_H2O2/HvsT_H2O2 Treatment_AOs up in TIGK_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.H2O2treatment.AOs.TIGK.GOMF<-as.data.frame(enriched.H2O2treatment.AOs.TIGK$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.H2O2treatment.AOs.TIGK.GOMF$Overlap
enriched.H2O2treatment.AOs.TIGK.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.AOs.TIGK.GOMF, aes(x=enriched.H2O2treatment.AOs.TIGK.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.AOs.TIGK.GOMF$Adjusted.P.value, size=(enriched.H2O2treatment.AOs.TIGK.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HvsT_H2O2/HvsT_H2O2 Treatment_AOs up in TIGK_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.H2O2treatment.AOs.TIGK.GOCC<-as.data.frame(enriched.H2O2treatment.AOs.TIGK$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.H2O2treatment.AOs.TIGK.GOCC$Overlap
enriched.H2O2treatment.AOs.TIGK.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.AOs.TIGK.GOCC, aes(x=enriched.H2O2treatment.AOs.TIGK.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.AOs.TIGK.GOCC$Adjusted.P.value, size=(enriched.H2O2treatment.AOs.TIGK.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HvsT_H2O2/HvsT_H2O2 Treatment_AOs up in TIGK_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.H2O2treatment.AOs.TIGK.Reactome<-as.data.frame(enriched.H2O2treatment.AOs.TIGK$Reactome_2022)[1:10,]
frac <- enriched.H2O2treatment.AOs.TIGK.Reactome$Overlap
enriched.H2O2treatment.AOs.TIGK.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.AOs.TIGK.Reactome, aes(x=enriched.H2O2treatment.AOs.TIGK.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.AOs.TIGK.Reactome$Adjusted.P.value, size=(enriched.H2O2treatment.AOs.TIGK.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HvsT_H2O2/HvsT_H2O2 Treatment_AOs up in TIGK_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()
#Enrichment of HaCaT - H2O2 vs Control: Antioxidants upregulated in HaCaT after H2O2 treatment ####
enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2 <- enrichr(AOs.H2O2vsCtrl.HaCaT.upH2O2$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up HaCaT")
addWorksheet(Enrichments, "CC Up HaCaT")
addWorksheet(Enrichments, "MF Up HaCaT")
addWorksheet(Enrichments, "Reactome Up HaCaT")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up HaCaT", x = as.data.frame((as.data.frame(enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up HaCaT", x = as.data.frame((as.data.frame(enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up HaCaT", x = as.data.frame((as.data.frame(enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up HaCaT", x = as.data.frame((as.data.frame(enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HaCaT - H2O2 vs Control/AOs up in HaCaT after H2O2 treatment.xlsx")

#Dotplots for the enrichment
#GO BP
enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.GOBP<-as.data.frame(enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2$GO_Biological_Process_2023)[1:10,]
frac <- enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.GOBP$Overlap
enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.GOBP, aes(x=enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.GOBP$Adjusted.P.value, size=(enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HaCaT - H2O2 vs Control/AOs up in HaCaT after H2O2 treatment_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.GOMF<-as.data.frame(enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.GOMF$Overlap
enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.GOMF, aes(x=enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.GOMF$Adjusted.P.value, size=(enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HaCaT - H2O2 vs Control/AOs up in HaCaT after H2O2 treatment_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.GOCC<-as.data.frame(enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.GOCC$Overlap
enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.GOCC, aes(x=enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.GOCC$Adjusted.P.value, size=(enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HaCaT - H2O2 vs Control/AOs up in HaCaT after H2O2 treatment_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.Reactome<-as.data.frame(enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2$Reactome_2022)[1:10,]
frac <- enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.Reactome$Overlap
enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.Reactome, aes(x=enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.Reactome$Adjusted.P.value, size=(enriched.AOs.H2O2vsCtrl.HaCaT.upH2O2.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HaCaT - H2O2 vs Control/AOs up in HaCaT after H2O2 treatment_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()


##Enrichment of HaCaT - H2O2 vs Control: Antioxidants downregulated in HaCaT after H2O2 treatment ####
enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2 <- enrichr(AOs.H2O2vsCtrl.HaCaT.downH2O2$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up TIGK")
addWorksheet(Enrichments, "CC Up TIGK")
addWorksheet(Enrichments, "MF Up TIGK")
addWorksheet(Enrichments, "Reactome Up TIGK")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up TIGK", x = as.data.frame((as.data.frame(enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up TIGK", x = as.data.frame((as.data.frame(enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up TIGK", x = as.data.frame((as.data.frame(enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up TIGK", x = as.data.frame((as.data.frame(enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))# Export the file
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HaCaT - H2O2 vs Control/AOs down in HaCaT after H2O2 treatment.xlsx")


#GO BP
enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.GOBP<-as.data.frame(enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2$GO_Biological_Process_2023)[1:10,]
frac <- enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.GOBP$Overlap
enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.GOBP, aes(x=enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.GOBP$Adjusted.P.value, size=(enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HaCaT - H2O2 vs Control/AOs down in HaCaT after H2O2 treatment_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.GOMF<-as.data.frame(enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2$GO_Molecular_Function_2023)[1:2,]
frac <- enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.GOMF$Overlap
enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.GOMF, aes(x=enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.GOMF$Adjusted.P.value, size=(enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HaCaT - H2O2 vs Control/AOs down in HaCaT after H2O2 treatment_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.GOCC<-as.data.frame(enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2$GO_Cellular_Component_2023)[1:2,]
frac <- enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.GOCC$Overlap
enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.GOCC, aes(x=enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.GOCC$Adjusted.P.value, size=(enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HaCaT - H2O2 vs Control/AOs down in HaCaT after H2O2 treatment_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.Reactome<-as.data.frame(enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2$Reactome_2022)[1:7,]
frac <- enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.Reactome$Overlap
enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.Reactome, aes(x=enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.Reactome$Adjusted.P.value, size=(enriched.AOs.H2O2vsCtrl.HaCaT.downH2O2.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/HaCaT - H2O2 vs Control/AOs down in HaCaT after H2O2 treatment_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Enrichment of TIGK - H2O2 vs Control: Antioxidants upregulated in TIGK after H2O2 treatment ####
enriched.AOs.H2O2vsCtrl.TIGK.upH2O2 <- enrichr(AOs.H2O2vsCtrl.TIGK.upH2O2$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up HaCaT")
addWorksheet(Enrichments, "CC Up HaCaT")
addWorksheet(Enrichments, "MF Up HaCaT")
addWorksheet(Enrichments, "Reactome Up HaCaT")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up HaCaT", x = as.data.frame((as.data.frame(enriched.AOs.H2O2vsCtrl.TIGK.upH2O2$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up HaCaT", x = as.data.frame((as.data.frame(enriched.AOs.H2O2vsCtrl.TIGK.upH2O2$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up HaCaT", x = as.data.frame((as.data.frame(enriched.AOs.H2O2vsCtrl.TIGK.upH2O2$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up HaCaT", x = as.data.frame((as.data.frame(enriched.AOs.H2O2vsCtrl.TIGK.upH2O2$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/TIGK- H2O2 vs Control/AOs up in TIGK after H2O2 treatment.xlsx")

#Dotplots for the enrichment
#GO BP
enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.GOBP<-as.data.frame(enriched.AOs.H2O2vsCtrl.TIGK.upH2O2$GO_Biological_Process_2023)[1:10,]
frac <- enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.GOBP$Overlap
enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.GOBP, aes(x=enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.GOBP$Adjusted.P.value, size=(enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/TIGK- H2O2 vs Control/AOs up in TIGK after H2O2 treatment_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.GOMF<-as.data.frame(enriched.AOs.H2O2vsCtrl.TIGK.upH2O2$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.GOMF$Overlap
enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.GOMF, aes(x=enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.GOMF$Adjusted.P.value, size=(enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/TIGK- H2O2 vs Control/AOs up in TIGK after H2O2 treatment_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.GOCC<-as.data.frame(enriched.AOs.H2O2vsCtrl.TIGK.upH2O2$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.GOCC$Overlap
enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.GOCC, aes(x=enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.GOCC$Adjusted.P.value, size=(enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/TIGK- H2O2 vs Control/AOs up in TIGK after H2O2 treatment_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.Reactome<-as.data.frame(enriched.AOs.H2O2vsCtrl.TIGK.upH2O2$Reactome_2022)[1:10,]
frac <- enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.Reactome$Overlap
enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.Reactome, aes(x=enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.Reactome$Adjusted.P.value, size=(enriched.AOs.H2O2vsCtrl.TIGK.upH2O2.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/TIGK- H2O2 vs Control/AOs up in TIGK after H2O2 treatment_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()


##Enrichment of TIGK - H2O2 vs Control: Antioxidants downregulated in TIGK after H2O2 treatment ####
enriched.AOs.H2O2vsCtrl.TIGK.downH2O2 <- enrichr(AOs.H2O2vsCtrl.TIGK.downH2O2$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up TIGK")
addWorksheet(Enrichments, "CC Up TIGK")
addWorksheet(Enrichments, "MF Up TIGK")
addWorksheet(Enrichments, "Reactome Up TIGK")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up TIGK", x = as.data.frame((as.data.frame(enriched.AOs.H2O2vsCtrl.TIGK.downH2O2$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up TIGK", x = as.data.frame((as.data.frame(enriched.AOs.H2O2vsCtrl.TIGK.downH2O2$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up TIGK", x = as.data.frame((as.data.frame(enriched.AOs.H2O2vsCtrl.TIGK.downH2O2$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up TIGK", x = as.data.frame((as.data.frame(enriched.AOs.H2O2vsCtrl.TIGK.downH2O2$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))# Export the file
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/TIGK- H2O2 vs Control/AOs down in TIGK after H2O2 treatment.xlsx")


#GO BP
enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.GOBP<-as.data.frame(enriched.AOs.H2O2vsCtrl.TIGK.downH2O2$GO_Biological_Process_2023)[1:10,]
frac <- enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.GOBP$Overlap
enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.GOBP, aes(x=enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.GOBP$Adjusted.P.value, size=(enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/TIGK- H2O2 vs Control/AOs down in TIGK after H2O2 treatment_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.GOMF<-as.data.frame(enriched.AOs.H2O2vsCtrl.TIGK.downH2O2$GO_Molecular_Function_2023)[1:2,]
frac <- enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.GOMF$Overlap
enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.GOMF, aes(x=enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.GOMF$Adjusted.P.value, size=(enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/TIGK- H2O2 vs Control/AOs down in TIGK after H2O2 treatment_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.GOCC<-as.data.frame(enriched.AOs.H2O2vsCtrl.TIGK.downH2O2$GO_Cellular_Component_2023)[1:2,]
frac <- enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.GOCC$Overlap
enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.GOCC, aes(x=enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.GOCC$Adjusted.P.value, size=(enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/TIGK- H2O2 vs Control/AOs down in TIGK after H2O2 treatment_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.Reactome<-as.data.frame(enriched.AOs.H2O2vsCtrl.TIGK.downH2O2$Reactome_2022)[1:7,]
frac <- enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.Reactome$Overlap
enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.Reactome, aes(x=enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.Reactome$Adjusted.P.value, size=(enriched.AOs.H2O2vsCtrl.TIGK.downH2O2.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Antioxidant Genes/TIGK- H2O2 vs Control/AOs down in TIGK after H2O2 treatment_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#### Enrichment for the prooxidant genes ####
#Enrichment of HvsT Control: ProOxidants upregulated in HaCaT relative to TIGK ####
enriched.Ctrl.POs.HaCaT <- enrichr(Ctrl.POs.HaCaT$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up HaCaT")
addWorksheet(Enrichments, "CC Up HaCaT")
addWorksheet(Enrichments, "MF Up HaCaT")
addWorksheet(Enrichments, "Reactome Up HaCaT")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up HaCaT", x = as.data.frame((as.data.frame(enriched.Ctrl.POs.HaCaT$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up HaCaT", x = as.data.frame((as.data.frame(enriched.Ctrl.POs.HaCaT$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up HaCaT", x = as.data.frame((as.data.frame(enriched.Ctrl.POs.HaCaT$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up HaCaT", x = as.data.frame((as.data.frame(enriched.Ctrl.POs.HaCaT$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HvsT_Ctrl_POs up in HaCaT.xlsx")

#Dotplots for the enrichment
#GO BP
enriched.Ctrl.POs.HaCaT.GOBP<-as.data.frame(enriched.Ctrl.POs.HaCaT$GO_Biological_Process_2023)[1:10,]
frac <- enriched.Ctrl.POs.HaCaT.GOBP$Overlap
enriched.Ctrl.POs.HaCaT.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.POs.HaCaT.GOBP, aes(x=enriched.Ctrl.POs.HaCaT.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.POs.HaCaT.GOBP$Adjusted.P.value, size=(enriched.Ctrl.POs.HaCaT.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HvsT_Control/HvsT_Ctrl_POs up in HaCaT_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.Ctrl.POs.HaCaT.GOMF<-as.data.frame(enriched.Ctrl.POs.HaCaT$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.Ctrl.POs.HaCaT.GOMF$Overlap
enriched.Ctrl.POs.HaCaT.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.POs.HaCaT.GOMF, aes(x=enriched.Ctrl.POs.HaCaT.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.POs.HaCaT.GOMF$Adjusted.P.value, size=(enriched.Ctrl.POs.HaCaT.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HvsT_Control/HvsT_Ctrl_POs up in HaCaT_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.Ctrl.POs.HaCaT.GOCC<-as.data.frame(enriched.Ctrl.POs.HaCaT$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.Ctrl.POs.HaCaT.GOCC$Overlap
enriched.Ctrl.POs.HaCaT.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.POs.HaCaT.GOCC, aes(x=enriched.Ctrl.POs.HaCaT.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.POs.HaCaT.GOCC$Adjusted.P.value, size=(enriched.Ctrl.POs.HaCaT.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HvsT_Control/HvsT_Ctrl_POs up in HaCaT_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.Ctrl.POs.HaCaT.Reactome<-as.data.frame(enriched.Ctrl.POs.HaCaT$Reactome_2022)[1:10,]
frac <- enriched.Ctrl.POs.HaCaT.Reactome$Overlap
enriched.Ctrl.POs.HaCaT.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.POs.HaCaT.Reactome, aes(x=enriched.Ctrl.POs.HaCaT.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.POs.HaCaT.Reactome$Adjusted.P.value, size=(enriched.Ctrl.POs.HaCaT.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HvsT_Control/HvsT_Ctrl_POs up in HaCaT_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()


##Enrichment of HvsT Control: ProOxidants upregulated in TIGK relative to HaCaT ####
enriched.Ctrl.POs.TIGK <- enrichr(Ctrl.POs.TIGK$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up TIGK")
addWorksheet(Enrichments, "CC Up TIGK")
addWorksheet(Enrichments, "MF Up TIGK")
addWorksheet(Enrichments, "Reactome Up TIGK")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up TIGK", x = as.data.frame((as.data.frame(enriched.Ctrl.POs.TIGK$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up TIGK", x = as.data.frame((as.data.frame(enriched.Ctrl.POs.TIGK$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up TIGK", x = as.data.frame((as.data.frame(enriched.Ctrl.POs.TIGK$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up TIGK", x = as.data.frame((as.data.frame(enriched.Ctrl.POs.TIGK$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))# Export the file
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HvsT_Ctrl_POs up in TIGK.xlsx")


#GO BP
enriched.Ctrl.POs.TIGK.GOBP<-as.data.frame(enriched.Ctrl.POs.TIGK$GO_Biological_Process_2023)[1:10,]
frac <- enriched.Ctrl.POs.TIGK.GOBP$Overlap
enriched.Ctrl.POs.TIGK.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.POs.TIGK.GOBP, aes(x=enriched.Ctrl.POs.TIGK.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.POs.TIGK.GOBP$Adjusted.P.value, size=(enriched.Ctrl.POs.TIGK.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HvsT_Control/HvsT_Ctrl_POs up in TIGK_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.Ctrl.POs.TIGK.GOMF<-as.data.frame(enriched.Ctrl.POs.TIGK$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.Ctrl.POs.TIGK.GOMF$Overlap
enriched.Ctrl.POs.TIGK.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.POs.TIGK.GOMF, aes(x=enriched.Ctrl.POs.TIGK.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.POs.TIGK.GOMF$Adjusted.P.value, size=(enriched.Ctrl.POs.TIGK.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HvsT_Control/HvsT_Ctrl_POs up in TIGK_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.Ctrl.POs.TIGK.GOCC<-as.data.frame(enriched.Ctrl.POs.TIGK$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.Ctrl.POs.TIGK.GOCC$Overlap
enriched.Ctrl.POs.TIGK.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.POs.TIGK.GOCC, aes(x=enriched.Ctrl.POs.TIGK.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.POs.TIGK.GOCC$Adjusted.P.value, size=(enriched.Ctrl.POs.TIGK.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HvsT_Control/HvsT_Ctrl_POs up in TIGK_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.Ctrl.POs.TIGK.Reactome<-as.data.frame(enriched.Ctrl.POs.TIGK$Reactome_2022)[1:10,]
frac <- enriched.Ctrl.POs.TIGK.Reactome$Overlap
enriched.Ctrl.POs.TIGK.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.POs.TIGK.Reactome, aes(x=enriched.Ctrl.POs.TIGK.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.POs.TIGK.Reactome$Adjusted.P.value, size=(enriched.Ctrl.POs.TIGK.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HvsT_Control/HvsT_Ctrl_POs up in TIGK_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Enrichment of HvsT after H2O2 Treatment: ProOxidants upregulated in HaCaT relative to TIGK ####
enriched.H2O2treatment.POs.HaCaT <- enrichr(H2O2treatment.POs.HaCaT$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up HaCaT")
addWorksheet(Enrichments, "CC Up HaCaT")
addWorksheet(Enrichments, "MF Up HaCaT")
addWorksheet(Enrichments, "Reactome Up HaCaT")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up HaCaT", x = as.data.frame((as.data.frame(enriched.H2O2treatment.POs.HaCaT$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up HaCaT", x = as.data.frame((as.data.frame(enriched.H2O2treatment.POs.HaCaT$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up HaCaT", x = as.data.frame((as.data.frame(enriched.H2O2treatment.POs.HaCaT$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up HaCaT", x = as.data.frame((as.data.frame(enriched.H2O2treatment.POs.HaCaT$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HvsT_H2O2/HvsT_H2O2 Treatment_POs up in HaCaT.xlsx")

#Dotplots for the enrichment
#GO BP
enriched.H2O2treatment.POs.HaCaT.GOBP<-as.data.frame(enriched.H2O2treatment.POs.HaCaT$GO_Biological_Process_2023)[1:10,]
frac <- enriched.H2O2treatment.POs.HaCaT.GOBP$Overlap
enriched.H2O2treatment.POs.HaCaT.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.POs.HaCaT.GOBP, aes(x=enriched.H2O2treatment.POs.HaCaT.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.POs.HaCaT.GOBP$Adjusted.P.value, size=(enriched.H2O2treatment.POs.HaCaT.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HvsT_H2O2/HvsT_H2O2 Treatment_POs up in HaCaT_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.H2O2treatment.POs.HaCaT.GOMF<-as.data.frame(enriched.H2O2treatment.POs.HaCaT$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.H2O2treatment.POs.HaCaT.GOMF$Overlap
enriched.H2O2treatment.POs.HaCaT.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.POs.HaCaT.GOMF, aes(x=enriched.H2O2treatment.POs.HaCaT.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.POs.HaCaT.GOMF$Adjusted.P.value, size=(enriched.H2O2treatment.POs.HaCaT.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HvsT_H2O2/HvsT_H2O2 Treatment_POs up in HaCaT_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.H2O2treatment.POs.HaCaT.GOCC<-as.data.frame(enriched.H2O2treatment.POs.HaCaT$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.H2O2treatment.POs.HaCaT.GOCC$Overlap
enriched.H2O2treatment.POs.HaCaT.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.POs.HaCaT.GOCC, aes(x=enriched.H2O2treatment.POs.HaCaT.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.POs.HaCaT.GOCC$Adjusted.P.value, size=(enriched.H2O2treatment.POs.HaCaT.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HvsT_H2O2/HvsT_H2O2 Treatment_POs up in HaCaT_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.H2O2treatment.POs.HaCaT.Reactome<-as.data.frame(enriched.H2O2treatment.POs.HaCaT$Reactome_2022)[1:10,]
frac <- enriched.H2O2treatment.POs.HaCaT.Reactome$Overlap
enriched.H2O2treatment.POs.HaCaT.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.POs.HaCaT.Reactome, aes(x=enriched.H2O2treatment.POs.HaCaT.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.POs.HaCaT.Reactome$Adjusted.P.value, size=(enriched.H2O2treatment.POs.HaCaT.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HvsT_H2O2/HvsT_H2O2 Treatment_POs up in HaCaT_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()


##Enrichment of HvsT after H2O2 Treatment: ProOxidants upregulated in TIGK relative to HaCaT ####
enriched.H2O2treatment.POs.TIGK <- enrichr(H2O2treatment.POs.TIGK$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up TIGK")
addWorksheet(Enrichments, "CC Up TIGK")
addWorksheet(Enrichments, "MF Up TIGK")
addWorksheet(Enrichments, "Reactome Up TIGK")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up TIGK", x = as.data.frame((as.data.frame(enriched.H2O2treatment.POs.TIGK$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up TIGK", x = as.data.frame((as.data.frame(enriched.H2O2treatment.POs.TIGK$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up TIGK", x = as.data.frame((as.data.frame(enriched.H2O2treatment.POs.TIGK$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up TIGK", x = as.data.frame((as.data.frame(enriched.H2O2treatment.POs.TIGK$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))# Export the file
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HvsT_H2O2/HvsT_H2O2 Treatment_POs up in TIGK.xlsx")


#GO BP
enriched.H2O2treatment.POs.TIGK.GOBP<-as.data.frame(enriched.H2O2treatment.POs.TIGK$GO_Biological_Process_2023)[1:10,]
frac <- enriched.H2O2treatment.POs.TIGK.GOBP$Overlap
enriched.H2O2treatment.POs.TIGK.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.POs.TIGK.GOBP, aes(x=enriched.H2O2treatment.POs.TIGK.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.POs.TIGK.GOBP$Adjusted.P.value, size=(enriched.H2O2treatment.POs.TIGK.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HvsT_H2O2/HvsT_H2O2 Treatment_POs up in TIGK_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.H2O2treatment.POs.TIGK.GOMF<-as.data.frame(enriched.H2O2treatment.POs.TIGK$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.H2O2treatment.POs.TIGK.GOMF$Overlap
enriched.H2O2treatment.POs.TIGK.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.POs.TIGK.GOMF, aes(x=enriched.H2O2treatment.POs.TIGK.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.POs.TIGK.GOMF$Adjusted.P.value, size=(enriched.H2O2treatment.POs.TIGK.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HvsT_H2O2/HvsT_H2O2 Treatment_POs up in TIGK_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.H2O2treatment.POs.TIGK.GOCC<-as.data.frame(enriched.H2O2treatment.POs.TIGK$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.H2O2treatment.POs.TIGK.GOCC$Overlap
enriched.H2O2treatment.POs.TIGK.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.POs.TIGK.GOCC, aes(x=enriched.H2O2treatment.POs.TIGK.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.POs.TIGK.GOCC$Adjusted.P.value, size=(enriched.H2O2treatment.POs.TIGK.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HvsT_H2O2/HvsT_H2O2 Treatment_POs up in TIGK_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.H2O2treatment.POs.TIGK.Reactome<-as.data.frame(enriched.H2O2treatment.POs.TIGK$Reactome_2022)[1:10,]
frac <- enriched.H2O2treatment.POs.TIGK.Reactome$Overlap
enriched.H2O2treatment.POs.TIGK.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.POs.TIGK.Reactome, aes(x=enriched.H2O2treatment.POs.TIGK.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.POs.TIGK.Reactome$Adjusted.P.value, size=(enriched.H2O2treatment.POs.TIGK.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HvsT_H2O2/HvsT_H2O2 Treatment_POs up in TIGK_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()
#Enrichment of HaCaT - H2O2 vs Control: ProOxidants upregulated in HaCaT after H2O2 treatment ####
enriched.POs.H2O2vsCtrl.HaCaT.upH2O2 <- enrichr(POs.H2O2vsCtrl.HaCaT.upH2O2$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up HaCaT")
addWorksheet(Enrichments, "CC Up HaCaT")
addWorksheet(Enrichments, "MF Up HaCaT")
addWorksheet(Enrichments, "Reactome Up HaCaT")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up HaCaT", x = as.data.frame((as.data.frame(enriched.POs.H2O2vsCtrl.HaCaT.upH2O2$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up HaCaT", x = as.data.frame((as.data.frame(enriched.POs.H2O2vsCtrl.HaCaT.upH2O2$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up HaCaT", x = as.data.frame((as.data.frame(enriched.POs.H2O2vsCtrl.HaCaT.upH2O2$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up HaCaT", x = as.data.frame((as.data.frame(enriched.POs.H2O2vsCtrl.HaCaT.upH2O2$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HaCaT - H2O2 vs Control/POs up in HaCaT after H2O2 treatment.xlsx")

#Dotplots for the enrichment
#GO BP
enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.GOBP<-as.data.frame(enriched.POs.H2O2vsCtrl.HaCaT.upH2O2$GO_Biological_Process_2023)[1:10,]
frac <- enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.GOBP$Overlap
enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.GOBP, aes(x=enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.GOBP$Adjusted.P.value, size=(enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HaCaT - H2O2 vs Control/POs up in HaCaT after H2O2 treatment_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.GOMF<-as.data.frame(enriched.POs.H2O2vsCtrl.HaCaT.upH2O2$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.GOMF$Overlap
enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.GOMF, aes(x=enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.GOMF$Adjusted.P.value, size=(enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HaCaT - H2O2 vs Control/POs up in HaCaT after H2O2 treatment_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.GOCC<-as.data.frame(enriched.POs.H2O2vsCtrl.HaCaT.upH2O2$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.GOCC$Overlap
enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.GOCC, aes(x=enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.GOCC$Adjusted.P.value, size=(enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HaCaT - H2O2 vs Control/POs up in HaCaT after H2O2 treatment_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.Reactome<-as.data.frame(enriched.POs.H2O2vsCtrl.HaCaT.upH2O2$Reactome_2022)[1:10,]
frac <- enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.Reactome$Overlap
enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.Reactome, aes(x=enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.Reactome$Adjusted.P.value, size=(enriched.POs.H2O2vsCtrl.HaCaT.upH2O2.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HaCaT - H2O2 vs Control/POs up in HaCaT after H2O2 treatment_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()


##Enrichment of HaCaT - H2O2 vs Control: ProOxidants downregulated in HaCaT after H2O2 treatment ####
enriched.POs.H2O2vsCtrl.HaCaT.downH2O2 <- enrichr(POs.H2O2vsCtrl.HaCaT.downH2O2$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up TIGK")
addWorksheet(Enrichments, "CC Up TIGK")
addWorksheet(Enrichments, "MF Up TIGK")
addWorksheet(Enrichments, "Reactome Up TIGK")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up TIGK", x = as.data.frame((as.data.frame(enriched.POs.H2O2vsCtrl.HaCaT.downH2O2$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up TIGK", x = as.data.frame((as.data.frame(enriched.POs.H2O2vsCtrl.HaCaT.downH2O2$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up TIGK", x = as.data.frame((as.data.frame(enriched.POs.H2O2vsCtrl.HaCaT.downH2O2$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up TIGK", x = as.data.frame((as.data.frame(enriched.POs.H2O2vsCtrl.HaCaT.downH2O2$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))# Export the file
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HaCaT - H2O2 vs Control/POs down in HaCaT after H2O2 treatment.xlsx")


#GO BP
enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.GOBP<-as.data.frame(enriched.POs.H2O2vsCtrl.HaCaT.downH2O2$GO_Biological_Process_2023)[1:10,]
frac <- enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.GOBP$Overlap
enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.GOBP, aes(x=enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.GOBP$Adjusted.P.value, size=(enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HaCaT - H2O2 vs Control/POs down in HaCaT after H2O2 treatment_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.GOMF<-as.data.frame(enriched.POs.H2O2vsCtrl.HaCaT.downH2O2$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.GOMF$Overlap
enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.GOMF, aes(x=enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.GOMF$Adjusted.P.value, size=(enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HaCaT - H2O2 vs Control/POs down in HaCaT after H2O2 treatment_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.GOCC<-as.data.frame(enriched.POs.H2O2vsCtrl.HaCaT.downH2O2$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.GOCC$Overlap
enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.GOCC, aes(x=enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.GOCC$Adjusted.P.value, size=(enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HaCaT - H2O2 vs Control/POs down in HaCaT after H2O2 treatment_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.Reactome<-as.data.frame(enriched.POs.H2O2vsCtrl.HaCaT.downH2O2$Reactome_2022)[1:10,]
frac <- enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.Reactome$Overlap
enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.Reactome, aes(x=enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.Reactome$Adjusted.P.value, size=(enriched.POs.H2O2vsCtrl.HaCaT.downH2O2.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/HaCaT - H2O2 vs Control/POs down in HaCaT after H2O2 treatment_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Enrichment of TIGK - H2O2 vs Control: ProOxidants upregulated in TIGK after H2O2 treatment ####
enriched.POs.H2O2vsCtrl.TIGK.upH2O2 <- enrichr(POs.H2O2vsCtrl.TIGK.upH2O2$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up HaCaT")
addWorksheet(Enrichments, "CC Up HaCaT")
addWorksheet(Enrichments, "MF Up HaCaT")
addWorksheet(Enrichments, "Reactome Up HaCaT")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up HaCaT", x = as.data.frame((as.data.frame(enriched.POs.H2O2vsCtrl.TIGK.upH2O2$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up HaCaT", x = as.data.frame((as.data.frame(enriched.POs.H2O2vsCtrl.TIGK.upH2O2$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up HaCaT", x = as.data.frame((as.data.frame(enriched.POs.H2O2vsCtrl.TIGK.upH2O2$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up HaCaT", x = as.data.frame((as.data.frame(enriched.POs.H2O2vsCtrl.TIGK.upH2O2$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/TIGK - H2O2 vs Control/POs up in TIGK after H2O2 treatment.xlsx")

#Dotplots for the enrichment
#GO BP
enriched.POs.H2O2vsCtrl.TIGK.upH2O2.GOBP<-as.data.frame(enriched.POs.H2O2vsCtrl.TIGK.upH2O2$GO_Biological_Process_2023)[1:10,]
frac <- enriched.POs.H2O2vsCtrl.TIGK.upH2O2.GOBP$Overlap
enriched.POs.H2O2vsCtrl.TIGK.upH2O2.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.POs.H2O2vsCtrl.TIGK.upH2O2.GOBP, aes(x=enriched.POs.H2O2vsCtrl.TIGK.upH2O2.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.POs.H2O2vsCtrl.TIGK.upH2O2.GOBP$Adjusted.P.value, size=(enriched.POs.H2O2vsCtrl.TIGK.upH2O2.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/TIGK - H2O2 vs Control/POs up in TIGK after H2O2 treatment_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.POs.H2O2vsCtrl.TIGK.upH2O2.GOMF<-as.data.frame(enriched.POs.H2O2vsCtrl.TIGK.upH2O2$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.POs.H2O2vsCtrl.TIGK.upH2O2.GOMF$Overlap
enriched.POs.H2O2vsCtrl.TIGK.upH2O2.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.POs.H2O2vsCtrl.TIGK.upH2O2.GOMF, aes(x=enriched.POs.H2O2vsCtrl.TIGK.upH2O2.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.POs.H2O2vsCtrl.TIGK.upH2O2.GOMF$Adjusted.P.value, size=(enriched.POs.H2O2vsCtrl.TIGK.upH2O2.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/TIGK - H2O2 vs Control/POs up in TIGK after H2O2 treatment_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.POs.H2O2vsCtrl.TIGK.upH2O2.GOCC<-as.data.frame(enriched.POs.H2O2vsCtrl.TIGK.upH2O2$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.POs.H2O2vsCtrl.TIGK.upH2O2.GOCC$Overlap
enriched.POs.H2O2vsCtrl.TIGK.upH2O2.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.POs.H2O2vsCtrl.TIGK.upH2O2.GOCC, aes(x=enriched.POs.H2O2vsCtrl.TIGK.upH2O2.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.POs.H2O2vsCtrl.TIGK.upH2O2.GOCC$Adjusted.P.value, size=(enriched.POs.H2O2vsCtrl.TIGK.upH2O2.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/TIGK - H2O2 vs Control/POs up in TIGK after H2O2 treatment_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.POs.H2O2vsCtrl.TIGK.upH2O2.Reactome<-as.data.frame(enriched.POs.H2O2vsCtrl.TIGK.upH2O2$Reactome_2022)[1:10,]
frac <- enriched.POs.H2O2vsCtrl.TIGK.upH2O2.Reactome$Overlap
enriched.POs.H2O2vsCtrl.TIGK.upH2O2.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.POs.H2O2vsCtrl.TIGK.upH2O2.Reactome, aes(x=enriched.POs.H2O2vsCtrl.TIGK.upH2O2.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.POs.H2O2vsCtrl.TIGK.upH2O2.Reactome$Adjusted.P.value, size=(enriched.POs.H2O2vsCtrl.TIGK.upH2O2.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/TIGK - H2O2 vs Control/POs up in TIGK after H2O2 treatment_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()


##Enrichment of TIGK - H2O2 vs Control: ProOxidants downregulated in TIGK after H2O2 treatment ####
enriched.POs.H2O2vsCtrl.TIGK.downH2O2 <- enrichr(POs.H2O2vsCtrl.TIGK.downH2O2$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up TIGK")
addWorksheet(Enrichments, "CC Up TIGK")
addWorksheet(Enrichments, "MF Up TIGK")
addWorksheet(Enrichments, "Reactome Up TIGK")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up TIGK", x = as.data.frame((as.data.frame(enriched.POs.H2O2vsCtrl.TIGK.downH2O2$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up TIGK", x = as.data.frame((as.data.frame(enriched.POs.H2O2vsCtrl.TIGK.downH2O2$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up TIGK", x = as.data.frame((as.data.frame(enriched.POs.H2O2vsCtrl.TIGK.downH2O2$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up TIGK", x = as.data.frame((as.data.frame(enriched.POs.H2O2vsCtrl.TIGK.downH2O2$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))# Export the file
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/TIGK - H2O2 vs Control/POs down in TIGK after H2O2 treatment.xlsx")


#GO BP
enriched.POs.H2O2vsCtrl.TIGK.downH2O2.GOBP<-as.data.frame(enriched.POs.H2O2vsCtrl.TIGK.downH2O2$GO_Biological_Process_2023)[1:10,]
frac <- enriched.POs.H2O2vsCtrl.TIGK.downH2O2.GOBP$Overlap
enriched.POs.H2O2vsCtrl.TIGK.downH2O2.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.POs.H2O2vsCtrl.TIGK.downH2O2.GOBP, aes(x=enriched.POs.H2O2vsCtrl.TIGK.downH2O2.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.POs.H2O2vsCtrl.TIGK.downH2O2.GOBP$Adjusted.P.value, size=(enriched.POs.H2O2vsCtrl.TIGK.downH2O2.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/TIGK - H2O2 vs Control/POs down in TIGK after H2O2 treatment_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.POs.H2O2vsCtrl.TIGK.downH2O2.GOMF<-as.data.frame(enriched.POs.H2O2vsCtrl.TIGK.downH2O2$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.POs.H2O2vsCtrl.TIGK.downH2O2.GOMF$Overlap
enriched.POs.H2O2vsCtrl.TIGK.downH2O2.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.POs.H2O2vsCtrl.TIGK.downH2O2.GOMF, aes(x=enriched.POs.H2O2vsCtrl.TIGK.downH2O2.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.POs.H2O2vsCtrl.TIGK.downH2O2.GOMF$Adjusted.P.value, size=(enriched.POs.H2O2vsCtrl.TIGK.downH2O2.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/TIGK - H2O2 vs Control/POs down in TIGK after H2O2 treatment_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.POs.H2O2vsCtrl.TIGK.downH2O2.GOCC<-as.data.frame(enriched.POs.H2O2vsCtrl.TIGK.downH2O2$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.POs.H2O2vsCtrl.TIGK.downH2O2.GOCC$Overlap
enriched.POs.H2O2vsCtrl.TIGK.downH2O2.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.POs.H2O2vsCtrl.TIGK.downH2O2.GOCC, aes(x=enriched.POs.H2O2vsCtrl.TIGK.downH2O2.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.POs.H2O2vsCtrl.TIGK.downH2O2.GOCC$Adjusted.P.value, size=(enriched.POs.H2O2vsCtrl.TIGK.downH2O2.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/TIGK - H2O2 vs Control/POs down in TIGK after H2O2 treatment_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.POs.H2O2vsCtrl.TIGK.downH2O2.Reactome<-as.data.frame(enriched.POs.H2O2vsCtrl.TIGK.downH2O2$Reactome_2022)[1:10,]
frac <- enriched.POs.H2O2vsCtrl.TIGK.downH2O2.Reactome$Overlap
enriched.POs.H2O2vsCtrl.TIGK.downH2O2.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.POs.H2O2vsCtrl.TIGK.downH2O2.Reactome, aes(x=enriched.POs.H2O2vsCtrl.TIGK.downH2O2.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.POs.H2O2vsCtrl.TIGK.downH2O2.Reactome$Adjusted.P.value, size=(enriched.POs.H2O2vsCtrl.TIGK.downH2O2.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of ProOxidant Genes/TIGK - H2O2 vs Control/POs down in TIGK after H2O2 treatment_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#### Pulling out the genes related to ROS production and Cell Cycle Genes ####
Cell_Cycle_Genes<-read.csv("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/Cell_Cycle_Genes.csv")

# Cell Cycle Genes (CellCycle) - HaCaT vs TIGK (Baseline)####
Ctrl.CellCycle.HvsT<-subset(HvsT.Ctrl, symbol %in% Cell_Cycle_Genes$Gene)
nrow(Ctrl.CellCycle.HvsT)

mat.Ctrl.CellCycle.HvsT<-counts(dds.HvsT.Ctrl, normalized = T)[Ctrl.CellCycle.HvsT$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.Ctrl.CellCycle.HvsT.z<-t(apply(mat.Ctrl.CellCycle.HvsT, 1, scale))
colnames(mat.Ctrl.CellCycle.HvsT.z)<-colnames(mat.Ctrl.CellCycle.HvsT)
col.order <- c("Hctrl1","Hctrl2","Hctrl3","Tctrl1","Tctrl2","Tctrl3")
mat.Ctrl.CellCycle.HvsT.z<-mat.Ctrl.CellCycle.HvsT.z[,col.order]
rownames(mat.Ctrl.CellCycle.HvsT.z)
p1<-pheatmap(mat.Ctrl.CellCycle.HvsT.z, labels_row = Ctrl.CellCycle.HvsT$symbol, 
             cluster_cols = FALSE,
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Cell Cycle Genes/Baseline/Cell Cycle Genes_HaCaT vs TIGK.Baseline.png",
    width = 3600,
    height = 3600,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(Ctrl.CellCycle.HvsT,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Cell Cycle Gene List/CellCycle.HaCaT vs TIGK.Baseline.csv")

# Cell Cycle Genes (CellCycle) - upregulated in HaCaT (Baseline)
Ctrl.CellCycle.HaCaT<-subset(HvsT.Ctrl.upHaCaT, symbol %in% Cell_Cycle_Genes$Gene)
nrow(Ctrl.CellCycle.HaCaT)

mat.Ctrl.CellCycle.HaCaT<-counts(dds.HvsT.Ctrl, normalized = T)[Ctrl.CellCycle.HaCaT$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.Ctrl.CellCycle.HaCaT.z<-t(apply(mat.Ctrl.CellCycle.HaCaT, 1, scale))
colnames(mat.Ctrl.CellCycle.HaCaT.z)<-colnames(mat.Ctrl.CellCycle.HaCaT)
rownames(mat.Ctrl.CellCycle.HaCaT.z)
col.order <- c("Hctrl1","Hctrl2","Hctrl3","Tctrl1","Tctrl2","Tctrl3")
mat.Ctrl.CellCycle.HaCaT.z<-mat.Ctrl.CellCycle.HaCaT.z[,col.order]

p1<-pheatmap(mat.Ctrl.CellCycle.HaCaT.z, labels_row = Ctrl.CellCycle.HaCaT$symbol,
             cluster_cols = FALSE,
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Cell Cycle Genes/Baseline/Cell Cycle Genes up in HaCaT_Baseline.png",
    width = 3600,
    height = 3600,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(Ctrl.CellCycle.HaCaT,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Cell Cycle Gene List/CellCycle.Upregulated in HaCaT at Baseline.csv")

# Cell Cycle Genes (CellCycle) - upregulated in TIGK (Baseline)
Ctrl.CellCycle.TIGK<-subset(HvsT.Ctrl.upTIGK, symbol %in% Cell_Cycle_Genes$Gene)
nrow(Ctrl.CellCycle.TIGK)

mat.Ctrl.CellCycle.TIGK<-counts(dds.HvsT.Ctrl, normalized = T)[Ctrl.CellCycle.TIGK$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.Ctrl.CellCycle.TIGK.z<-t(apply(mat.Ctrl.CellCycle.TIGK, 1, scale))
colnames(mat.Ctrl.CellCycle.TIGK.z)<-colnames(mat.Ctrl.CellCycle.TIGK)
rownames(mat.Ctrl.CellCycle.TIGK.z)
col.order <- c("Hctrl1","Hctrl2","Hctrl3","Tctrl1","Tctrl2","Tctrl3")
mat.Ctrl.CellCycle.TIGK.z<-mat.Ctrl.CellCycle.TIGK.z[,col.order]
p1<-pheatmap(mat.Ctrl.CellCycle.TIGK.z, labels_row = Ctrl.CellCycle.TIGK$symbol, 
             cluster_cols = FALSE,
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Cell Cycle Genes/Baseline/Cell Cycle Genes up in TIGK_Baseline.png",
    width = 3600,
    height = 3600,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(Ctrl.CellCycle.TIGK,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Cell Cycle Gene List/CellCycle.Upregulated in TIGK at Baseline.csv")

# Cell Cycle Genes (CellCycle) - HaCaT vs TIGK: H2O2 Treatment####
H2O2treatment.CellCycle<-subset(HvsT.H2O2, symbol %in% Cell_Cycle_Genes$Gene)
nrow(H2O2treatment.CellCycle)

mat.H2O2treatment.CellCycle<-counts(dds.HvsT.H2O2, normalized = T)[H2O2treatment.CellCycle$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.H2O2treatment.CellCycle.z<-t(apply(mat.H2O2treatment.CellCycle, 1, scale))
colnames(mat.H2O2treatment.CellCycle.z)<-colnames(mat.H2O2treatment.CellCycle)
rownames(mat.H2O2treatment.CellCycle.z)
col.order <- c("Hhp1","Hhp2","Hhp3","Thp1","Thp2","Thp3")
mat.H2O2treatment.CellCycle.z<-mat.H2O2treatment.CellCycle.z[,col.order]
H2O2treatment.CellCycle <- H2O2treatment.CellCycle %>% filter(!(H2O2treatment.CellCycle$X == "ENSG00000170846"))
p1<-pheatmap(mat.H2O2treatment.CellCycle.z, labels_row = H2O2treatment.CellCycle$symbol, 
             cluster_cols = FALSE,
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Cell Cycle Genes/H2O2 Treated/Cell Cycle Genes HaCaT vs TIGK_H2O2 Treatment.png",
    width = 3600,
    height = 3600,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(H2O2treatment.CellCycle,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Cell Cycle Gene List/CellCycle.HaCaT vs TIGK after H2O2 Treatment.csv")

# Cell Cycle Genes (CellCycle) - upregulated in HaCaT after H2O2 Treatment
H2O2treatment.CellCycle.HaCaT<-subset(HvsT.H2O2.upHaCaT, symbol %in% Cell_Cycle_Genes$Gene)
nrow(H2O2treatment.CellCycle.HaCaT)

mat.H2O2treatment.CellCycle.HaCaT<-counts(dds.HvsT.H2O2, normalized = T)[H2O2treatment.CellCycle.HaCaT$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.H2O2treatment.CellCycle.HaCaT.z<-t(apply(mat.H2O2treatment.CellCycle.HaCaT, 1, scale))
colnames(mat.H2O2treatment.CellCycle.HaCaT.z)<-colnames(mat.H2O2treatment.CellCycle.HaCaT)
rownames(mat.H2O2treatment.CellCycle.HaCaT.z)
col.order <- c("Hhp1","Hhp2","Hhp3","Thp1","Thp2","Thp3")
mat.H2O2treatment.CellCycle.HaCaT.z<-mat.H2O2treatment.CellCycle.HaCaT.z[,col.order]
H2O2treatment.CellCycle.HaCaT <- H2O2treatment.CellCycle.HaCaT %>% filter(!(H2O2treatment.CellCycle.HaCaT$X == "ENSG00000170846"))
p1<-pheatmap(mat.H2O2treatment.CellCycle.HaCaT.z, labels_row = H2O2treatment.CellCycle.HaCaT$symbol, 
             cluster_cols = FALSE, 
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Cell Cycle Genes/H2O2 Treated/Cell Cycle Genes up in HaCaT_H2O2 Treatment.png",
    width = 3600,
    height = 3600,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(H2O2treatment.CellCycle.HaCaT,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Cell Cycle Gene List/CellCycle.Upregulated in HaCaT after H2O2 Treatment.csv")

# Cell Cycle Genes (CellCycle) - upregulated in TIGK after H2O2 Treatment
H2O2treatment.CellCycle.TIGK<-subset(HvsT.H2O2.upTIGK, symbol %in% Cell_Cycle_Genes$Gene)
nrow(H2O2treatment.CellCycle.TIGK)

mat.H2O2treatment.CellCycle.TIGK<-counts(dds.HvsT.H2O2, normalized = T)[H2O2treatment.CellCycle.TIGK$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.H2O2treatment.CellCycle.TIGK.z<-t(apply(mat.H2O2treatment.CellCycle.TIGK, 1, scale))
colnames(mat.H2O2treatment.CellCycle.TIGK.z)<-colnames(mat.H2O2treatment.CellCycle.TIGK)
rownames(mat.H2O2treatment.CellCycle.TIGK.z)
col.order <- c("Hhp1","Hhp2","Hhp3","Thp1","Thp2","Thp3")
mat.H2O2treatment.CellCycle.TIGK.z<-mat.H2O2treatment.CellCycle.TIGK.z[,col.order]
H2O2treatment.CellCycle.TIGK <- H2O2treatment.CellCycle.TIGK %>% filter(!(H2O2treatment.CellCycle.TIGK$X == "ENSG00000170846"))
p1<-pheatmap(mat.H2O2treatment.CellCycle.TIGK.z, labels_row = H2O2treatment.CellCycle.TIGK$symbol, 
             cluster_cols = FALSE, 
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Cell Cycle Genes/H2O2 Treated/Cell Cycle Genes up in TIGK_H2O2 Treatment.png",
    width = 3600,
    height = 3600,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(H2O2treatment.CellCycle.TIGK,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Cell Cycle Gene List/CellCycle.Upregulated in TIGK after H2O2 Treatment.csv")

# Cell Cycle Genes (CellCycle) - HaCaT: H2O2 Treatment vs Baseline####
CellCycle.H2O2vsCtrl.HaCaT<-subset(H2O2vsCtrl.HaCaT, symbol %in% Cell_Cycle_Genes$Gene)
nrow(CellCycle.H2O2vsCtrl.HaCaT)

mat.CellCycle.H2O2vsCtrl.HaCaT<-counts(dds.H2O2vsCtrl.HaCaT, normalized = T)[CellCycle.H2O2vsCtrl.HaCaT$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.CellCycle.H2O2vsCtrl.HaCaT.z<-t(apply(mat.CellCycle.H2O2vsCtrl.HaCaT, 1, scale))
colnames(mat.CellCycle.H2O2vsCtrl.HaCaT.z)<-colnames(mat.CellCycle.H2O2vsCtrl.HaCaT)
rownames(mat.CellCycle.H2O2vsCtrl.HaCaT.z)
p1<-pheatmap(mat.CellCycle.H2O2vsCtrl.HaCaT.z, labels_row = CellCycle.H2O2vsCtrl.HaCaT$symbol, 
             cluster_cols = FALSE,
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Cell Cycle Genes/HaCaT_Treated vs Baseline/Cell Cycle Genes_H2O2 treatment vs control_HaCaT.png",
    width = 3600,
    height = 3600,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(CellCycle.H2O2vsCtrl.HaCaT,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Cell Cycle Gene List/CellCycle.HaCaT_H2O2 vs Ctrl.csv")

# Cell Cycle Genes (CellCycle) - upregulated in HaCaT after treatment
CellCycle.H2O2vsCtrl.HaCaT.upH2O2<-subset(H2O2vsCtrl.HaCaT.upH2O2, symbol %in% Cell_Cycle_Genes$Gene)
nrow(CellCycle.H2O2vsCtrl.HaCaT.upH2O2)

mat.CellCycle.H2O2vsCtrl.HaCaT.upH2O2<-counts(dds.H2O2vsCtrl.HaCaT, normalized = T)[CellCycle.H2O2vsCtrl.HaCaT.upH2O2$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.z<-t(apply(mat.CellCycle.H2O2vsCtrl.HaCaT.upH2O2, 1, scale))
colnames(mat.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.z)<-colnames(mat.CellCycle.H2O2vsCtrl.HaCaT.upH2O2)
rownames(mat.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.z)
p1<-pheatmap(mat.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.z, labels_row = CellCycle.H2O2vsCtrl.HaCaT.upH2O2$symbol, 
             cluster_cols = FALSE, 
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Cell Cycle Genes/HaCaT_Treated vs Baseline/Cell Cycle Genes_upregulated after H2O2 treatment_HaCaT.png",
    width = 3600,
    height = 3600,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(CellCycle.H2O2vsCtrl.HaCaT.upH2O2,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Cell Cycle Gene List/CellCycle.upregulated after H2O2_HaCaT.csv")

# Cell Cycle Genes (CellCycle) - downregulated in HaCaT after treatment
CellCycle.H2O2vsCtrl.HaCaT.downH2O2<-subset(H2O2vsCtrl.HaCaT.upCtrl, symbol %in% Cell_Cycle_Genes$Gene)
nrow(CellCycle.H2O2vsCtrl.HaCaT.downH2O2)

mat.CellCycle.H2O2vsCtrl.HaCaT.downH2O2<-counts(dds.H2O2vsCtrl.HaCaT, normalized = T)[CellCycle.H2O2vsCtrl.HaCaT.downH2O2$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.z<-t(apply(mat.CellCycle.H2O2vsCtrl.HaCaT.downH2O2, 1, scale))
colnames(mat.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.z)<-colnames(mat.CellCycle.H2O2vsCtrl.HaCaT.downH2O2)
rownames(mat.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.z)
p1<-pheatmap(mat.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.z, labels_row = CellCycle.H2O2vsCtrl.HaCaT.downH2O2$symbol, 
             cluster_cols = FALSE, 
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Cell Cycle Genes/HaCaT_Treated vs Baseline/Cell Cycle Genes_downregulated after H2O2 treatment_HaCaT.png",
    width = 3600,
    height = 3600,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(CellCycle.H2O2vsCtrl.HaCaT.downH2O2,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Cell Cycle Gene List/CellCycle.downregulated after H2O2_HaCaT.csv")


# Cell Cycle Genes (CellCycle) - TIGK: H2O2 Treatment vs Baseline####
CellCycle.H2O2vsCtrl.TIGK<-subset(H2O2vsCtrl.TIGK, symbol %in% Cell_Cycle_Genes$Gene)
nrow(CellCycle.H2O2vsCtrl.TIGK)

mat.CellCycle.H2O2vsCtrl.TIGK<-counts(dds.H2O2vsCtrl.TIGK, normalized = T)[CellCycle.H2O2vsCtrl.TIGK$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.CellCycle.H2O2vsCtrl.TIGK.z<-t(apply(mat.CellCycle.H2O2vsCtrl.TIGK, 1, scale))
colnames(mat.CellCycle.H2O2vsCtrl.TIGK.z)<-colnames(mat.CellCycle.H2O2vsCtrl.TIGK)
rownames(mat.CellCycle.H2O2vsCtrl.TIGK.z)
p1<-pheatmap(mat.CellCycle.H2O2vsCtrl.TIGK.z, labels_row = CellCycle.H2O2vsCtrl.TIGK$symbol, 
             cluster_cols = FALSE,
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Cell Cycle Genes/TIGK_Treated vs Baseline/Cell Cycle Genes_H2O2 treatment vs control_TIGK.png",
    width = 3600,
    height = 3600,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(CellCycle.H2O2vsCtrl.TIGK,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Cell Cycle Gene List/CellCycle.TIGK_H2O2 vs Ctrl.csv")

# Cell Cycle Genes (CellCycle) - upregulated in TIGK after treatment
CellCycle.H2O2vsCtrl.TIGK.upH2O2<-subset(H2O2vsCtrl.TIGK.upH2O2, symbol %in% Cell_Cycle_Genes$Gene)
nrow(CellCycle.H2O2vsCtrl.TIGK.upH2O2)

mat.CellCycle.H2O2vsCtrl.TIGK.upH2O2<-counts(dds.H2O2vsCtrl.TIGK, normalized = T)[CellCycle.H2O2vsCtrl.TIGK.upH2O2$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.CellCycle.H2O2vsCtrl.TIGK.upH2O2.z<-t(apply(mat.CellCycle.H2O2vsCtrl.TIGK.upH2O2, 1, scale))
colnames(mat.CellCycle.H2O2vsCtrl.TIGK.upH2O2.z)<-colnames(mat.CellCycle.H2O2vsCtrl.TIGK.upH2O2)
rownames(mat.CellCycle.H2O2vsCtrl.TIGK.upH2O2.z)
p1<-pheatmap(mat.CellCycle.H2O2vsCtrl.TIGK.upH2O2.z, labels_row = CellCycle.H2O2vsCtrl.TIGK.upH2O2$symbol, 
             cluster_cols = FALSE,
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Cell Cycle Genes/TIGK_Treated vs Baseline/Cell Cycle Genes_upregulated after H2O2 treatment_TIGK.png",
    width = 3600,
    height = 3600,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(CellCycle.H2O2vsCtrl.TIGK.upH2O2,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Cell Cycle Gene List/CellCycle.upregulated after H2O2_TIGK.csv")

# Cell Cycle Genes (CellCycle) - downregulated in TIGK after treatment
CellCycle.H2O2vsCtrl.TIGK.downH2O2<-subset(H2O2vsCtrl.TIGK.upCtrl, symbol %in% Cell_Cycle_Genes$Gene)
nrow(CellCycle.H2O2vsCtrl.TIGK.downH2O2)

mat.CellCycle.H2O2vsCtrl.TIGK.downH2O2<-counts(dds.H2O2vsCtrl.TIGK, normalized = T)[CellCycle.H2O2vsCtrl.TIGK.downH2O2$X,] #this allows you to get counts data for only the Ensembl IDs correlating to Diff. Expressed Collagens
mat.CellCycle.H2O2vsCtrl.TIGK.downH2O2.z<-t(apply(mat.CellCycle.H2O2vsCtrl.TIGK.downH2O2, 1, scale))
colnames(mat.CellCycle.H2O2vsCtrl.TIGK.downH2O2.z)<-colnames(mat.CellCycle.H2O2vsCtrl.TIGK.downH2O2)
rownames(mat.CellCycle.H2O2vsCtrl.TIGK.downH2O2.z)
p1<-pheatmap(mat.CellCycle.H2O2vsCtrl.TIGK.downH2O2.z, labels_row = CellCycle.H2O2vsCtrl.TIGK.downH2O2$symbol, 
             cluster_cols = FALSE,
             cellwidth = 60,
             show_colnames = T,
             fontsize_col = 20,
             fontsize = 20)
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Heatmap of Cell Cycle Genes/TIGK_Treated vs Baseline/Cell Cycle Genes_downregulated after H2O2 treatment_TIGK.png",
    width = 3600,
    height = 3600,
    units = "px",
    res = 250)
p1
dev.off()

write.csv(CellCycle.H2O2vsCtrl.TIGK.downH2O2,  
          file = "C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Cell Cycle Gene List/CellCycle.downregulated after H2O2_TIGK.csv")



#### Enrichment for the Cell Cycle Gene genes ####
#Enrichment of HvsT Control: Cell Cycle Genes upregulated in HaCaT relative to TIGK ####
enriched.Ctrl.CellCycle.HaCaT <- enrichr(Ctrl.CellCycle.HaCaT$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up HaCaT")
addWorksheet(Enrichments, "CC Up HaCaT")
addWorksheet(Enrichments, "MF Up HaCaT")
addWorksheet(Enrichments, "Reactome Up HaCaT")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up HaCaT", x = as.data.frame((as.data.frame(enriched.Ctrl.CellCycle.HaCaT$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up HaCaT", x = as.data.frame((as.data.frame(enriched.Ctrl.CellCycle.HaCaT$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up HaCaT", x = as.data.frame((as.data.frame(enriched.Ctrl.CellCycle.HaCaT$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up HaCaT", x = as.data.frame((as.data.frame(enriched.Ctrl.CellCycle.HaCaT$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HvsT_Control/HvsT_Ctrl_CellCycle up in HaCaT.xlsx")

#Dotplots for the enrichment
#GO BP
enriched.Ctrl.CellCycle.HaCaT.GOBP<-as.data.frame(enriched.Ctrl.CellCycle.HaCaT$GO_Biological_Process_2023)[1:10,]
frac <- enriched.Ctrl.CellCycle.HaCaT.GOBP$Overlap
enriched.Ctrl.CellCycle.HaCaT.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.CellCycle.HaCaT.GOBP, aes(x=enriched.Ctrl.CellCycle.HaCaT.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.CellCycle.HaCaT.GOBP$Adjusted.P.value, size=(enriched.Ctrl.CellCycle.HaCaT.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HvsT_Control/HvsT_Ctrl_CellCycle up in HaCaT_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.Ctrl.CellCycle.HaCaT.GOMF<-as.data.frame(enriched.Ctrl.CellCycle.HaCaT$GO_Molecular_Function_2023)[1:8,]
frac <- enriched.Ctrl.CellCycle.HaCaT.GOMF$Overlap
enriched.Ctrl.CellCycle.HaCaT.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.CellCycle.HaCaT.GOMF, aes(x=enriched.Ctrl.CellCycle.HaCaT.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.CellCycle.HaCaT.GOMF$Adjusted.P.value, size=(enriched.Ctrl.CellCycle.HaCaT.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HvsT_Control/HvsT_Ctrl_CellCycle up in HaCaT_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.Ctrl.CellCycle.HaCaT.GOCC<-as.data.frame(enriched.Ctrl.CellCycle.HaCaT$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.Ctrl.CellCycle.HaCaT.GOCC$Overlap
enriched.Ctrl.CellCycle.HaCaT.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.CellCycle.HaCaT.GOCC, aes(x=enriched.Ctrl.CellCycle.HaCaT.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.CellCycle.HaCaT.GOCC$Adjusted.P.value, size=(enriched.Ctrl.CellCycle.HaCaT.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HvsT_Control/HvsT_Ctrl_CellCycle up in HaCaT_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.Ctrl.CellCycle.HaCaT.Reactome<-as.data.frame(enriched.Ctrl.CellCycle.HaCaT$Reactome_2022)[1:10,]
frac <- enriched.Ctrl.CellCycle.HaCaT.Reactome$Overlap
enriched.Ctrl.CellCycle.HaCaT.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.CellCycle.HaCaT.Reactome, aes(x=enriched.Ctrl.CellCycle.HaCaT.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.CellCycle.HaCaT.Reactome$Adjusted.P.value, size=(enriched.Ctrl.CellCycle.HaCaT.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HvsT_Control/HvsT_Ctrl_CellCycle up in HaCaT_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()


##Enrichment of HvsT Control: Cell Cycle Genes upregulated in TIGK relative to HaCaT ####
enriched.Ctrl.CellCycle.TIGK <- enrichr(Ctrl.CellCycle.TIGK$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up TIGK")
addWorksheet(Enrichments, "CC Up TIGK")
addWorksheet(Enrichments, "MF Up TIGK")
addWorksheet(Enrichments, "Reactome Up TIGK")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up TIGK", x = as.data.frame((as.data.frame(enriched.Ctrl.CellCycle.TIGK$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up TIGK", x = as.data.frame((as.data.frame(enriched.Ctrl.CellCycle.TIGK$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up TIGK", x = as.data.frame((as.data.frame(enriched.Ctrl.CellCycle.TIGK$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up TIGK", x = as.data.frame((as.data.frame(enriched.Ctrl.CellCycle.TIGK$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))# Export the file
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HvsT_Control/HvsT_Ctrl_CellCycle up in TIGK.xlsx")


#GO BP
enriched.Ctrl.CellCycle.TIGK.GOBP<-as.data.frame(enriched.Ctrl.CellCycle.TIGK$GO_Biological_Process_2023)[1:10,]
frac <- enriched.Ctrl.CellCycle.TIGK.GOBP$Overlap
enriched.Ctrl.CellCycle.TIGK.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.CellCycle.TIGK.GOBP, aes(x=enriched.Ctrl.CellCycle.TIGK.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.CellCycle.TIGK.GOBP$Adjusted.P.value, size=(enriched.Ctrl.CellCycle.TIGK.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HvsT_Control/HvsT_Ctrl_CellCycle up in TIGK_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.Ctrl.CellCycle.TIGK.GOMF<-as.data.frame(enriched.Ctrl.CellCycle.TIGK$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.Ctrl.CellCycle.TIGK.GOMF$Overlap
enriched.Ctrl.CellCycle.TIGK.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.CellCycle.TIGK.GOMF, aes(x=enriched.Ctrl.CellCycle.TIGK.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.CellCycle.TIGK.GOMF$Adjusted.P.value, size=(enriched.Ctrl.CellCycle.TIGK.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HvsT_Control/HvsT_Ctrl_CellCycle up in TIGK_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.Ctrl.CellCycle.TIGK.GOCC<-as.data.frame(enriched.Ctrl.CellCycle.TIGK$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.Ctrl.CellCycle.TIGK.GOCC$Overlap
enriched.Ctrl.CellCycle.TIGK.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.CellCycle.TIGK.GOCC, aes(x=enriched.Ctrl.CellCycle.TIGK.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.CellCycle.TIGK.GOCC$Adjusted.P.value, size=(enriched.Ctrl.CellCycle.TIGK.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HvsT_Control/HvsT_Ctrl_CellCycle up in TIGK_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.Ctrl.CellCycle.TIGK.Reactome<-as.data.frame(enriched.Ctrl.CellCycle.TIGK$Reactome_2022)[1:10,]
frac <- enriched.Ctrl.CellCycle.TIGK.Reactome$Overlap
enriched.Ctrl.CellCycle.TIGK.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.Ctrl.CellCycle.TIGK.Reactome, aes(x=enriched.Ctrl.CellCycle.TIGK.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.Ctrl.CellCycle.TIGK.Reactome$Adjusted.P.value, size=(enriched.Ctrl.CellCycle.TIGK.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HvsT_Control/HvsT_Ctrl_CellCycle up in TIGK_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Enrichment of HvsT after H2O2 Treatment: Cell Cycle Genes upregulated in HaCaT relative to TIGK ####
enriched.H2O2treatment.CellCycle.HaCaT <- enrichr(H2O2treatment.CellCycle.HaCaT$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up HaCaT")
addWorksheet(Enrichments, "CC Up HaCaT")
addWorksheet(Enrichments, "MF Up HaCaT")
addWorksheet(Enrichments, "Reactome Up HaCaT")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up HaCaT", x = as.data.frame((as.data.frame(enriched.H2O2treatment.CellCycle.HaCaT$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up HaCaT", x = as.data.frame((as.data.frame(enriched.H2O2treatment.CellCycle.HaCaT$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up HaCaT", x = as.data.frame((as.data.frame(enriched.H2O2treatment.CellCycle.HaCaT$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up HaCaT", x = as.data.frame((as.data.frame(enriched.H2O2treatment.CellCycle.HaCaT$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HvsT_H2O2/HvsT_H2O2 Treatment_CellCycle up in HaCaT.xlsx")

#Dotplots for the enrichment
#GO BP
enriched.H2O2treatment.CellCycle.HaCaT.GOBP<-as.data.frame(enriched.H2O2treatment.CellCycle.HaCaT$GO_Biological_Process_2023)[1:10,]
frac <- enriched.H2O2treatment.CellCycle.HaCaT.GOBP$Overlap
enriched.H2O2treatment.CellCycle.HaCaT.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.CellCycle.HaCaT.GOBP, aes(x=enriched.H2O2treatment.CellCycle.HaCaT.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.CellCycle.HaCaT.GOBP$Adjusted.P.value, size=(enriched.H2O2treatment.CellCycle.HaCaT.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HvsT_H2O2/HvsT_H2O2 Treatment_CellCycle up in HaCaT_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.H2O2treatment.CellCycle.HaCaT.GOMF<-as.data.frame(enriched.H2O2treatment.CellCycle.HaCaT$GO_Molecular_Function_2023)[1:8,]
frac <- enriched.H2O2treatment.CellCycle.HaCaT.GOMF$Overlap
enriched.H2O2treatment.CellCycle.HaCaT.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.CellCycle.HaCaT.GOMF, aes(x=enriched.H2O2treatment.CellCycle.HaCaT.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.CellCycle.HaCaT.GOMF$Adjusted.P.value, size=(enriched.H2O2treatment.CellCycle.HaCaT.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HvsT_H2O2/HvsT_H2O2 Treatment_CellCycle up in HaCaT_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.H2O2treatment.CellCycle.HaCaT.GOCC<-as.data.frame(enriched.H2O2treatment.CellCycle.HaCaT$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.H2O2treatment.CellCycle.HaCaT.GOCC$Overlap
enriched.H2O2treatment.CellCycle.HaCaT.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.CellCycle.HaCaT.GOCC, aes(x=enriched.H2O2treatment.CellCycle.HaCaT.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.CellCycle.HaCaT.GOCC$Adjusted.P.value, size=(enriched.H2O2treatment.CellCycle.HaCaT.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HvsT_H2O2/HvsT_H2O2 Treatment_CellCycle up in HaCaT_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.H2O2treatment.CellCycle.HaCaT.Reactome<-as.data.frame(enriched.H2O2treatment.CellCycle.HaCaT$Reactome_2022)[1:10,]
frac <- enriched.H2O2treatment.CellCycle.HaCaT.Reactome$Overlap
enriched.H2O2treatment.CellCycle.HaCaT.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.CellCycle.HaCaT.Reactome, aes(x=enriched.H2O2treatment.CellCycle.HaCaT.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.CellCycle.HaCaT.Reactome$Adjusted.P.value, size=(enriched.H2O2treatment.CellCycle.HaCaT.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HvsT_H2O2/HvsT_H2O2 Treatment_CellCycle up in HaCaT_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()


##Enrichment of HvsT after H2O2 Treatment: Cell Cycle Genes upregulated in TIGK relative to HaCaT ####
enriched.H2O2treatment.CellCycle.TIGK <- enrichr(H2O2treatment.CellCycle.TIGK$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up TIGK")
addWorksheet(Enrichments, "CC Up TIGK")
addWorksheet(Enrichments, "MF Up TIGK")
addWorksheet(Enrichments, "Reactome Up TIGK")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up TIGK", x = as.data.frame((as.data.frame(enriched.H2O2treatment.CellCycle.TIGK$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up TIGK", x = as.data.frame((as.data.frame(enriched.H2O2treatment.CellCycle.TIGK$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up TIGK", x = as.data.frame((as.data.frame(enriched.H2O2treatment.CellCycle.TIGK$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up TIGK", x = as.data.frame((as.data.frame(enriched.H2O2treatment.CellCycle.TIGK$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))# Export the file
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HvsT_H2O2/HvsT_H2O2 Treatment_CellCycle up in TIGK.xlsx")


#GO BP
enriched.H2O2treatment.CellCycle.TIGK.GOBP<-as.data.frame(enriched.H2O2treatment.CellCycle.TIGK$GO_Biological_Process_2023)[1:10,]
frac <- enriched.H2O2treatment.CellCycle.TIGK.GOBP$Overlap
enriched.H2O2treatment.CellCycle.TIGK.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.CellCycle.TIGK.GOBP, aes(x=enriched.H2O2treatment.CellCycle.TIGK.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.CellCycle.TIGK.GOBP$Adjusted.P.value, size=(enriched.H2O2treatment.CellCycle.TIGK.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HvsT_H2O2/HvsT_H2O2 Treatment_CellCycle up in TIGK_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.H2O2treatment.CellCycle.TIGK.GOMF<-as.data.frame(enriched.H2O2treatment.CellCycle.TIGK$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.H2O2treatment.CellCycle.TIGK.GOMF$Overlap
enriched.H2O2treatment.CellCycle.TIGK.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.CellCycle.TIGK.GOMF, aes(x=enriched.H2O2treatment.CellCycle.TIGK.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.CellCycle.TIGK.GOMF$Adjusted.P.value, size=(enriched.H2O2treatment.CellCycle.TIGK.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HvsT_H2O2/HvsT_H2O2 Treatment_CellCycle up in TIGK_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.H2O2treatment.CellCycle.TIGK.GOCC<-as.data.frame(enriched.H2O2treatment.CellCycle.TIGK$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.H2O2treatment.CellCycle.TIGK.GOCC$Overlap
enriched.H2O2treatment.CellCycle.TIGK.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.CellCycle.TIGK.GOCC, aes(x=enriched.H2O2treatment.CellCycle.TIGK.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.CellCycle.TIGK.GOCC$Adjusted.P.value, size=(enriched.H2O2treatment.CellCycle.TIGK.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HvsT_H2O2/HvsT_H2O2 Treatment_CellCycle up in TIGK_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.H2O2treatment.CellCycle.TIGK.Reactome<-as.data.frame(enriched.H2O2treatment.CellCycle.TIGK$Reactome_2022)[1:10,]
frac <- enriched.H2O2treatment.CellCycle.TIGK.Reactome$Overlap
enriched.H2O2treatment.CellCycle.TIGK.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.H2O2treatment.CellCycle.TIGK.Reactome, aes(x=enriched.H2O2treatment.CellCycle.TIGK.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.H2O2treatment.CellCycle.TIGK.Reactome$Adjusted.P.value, size=(enriched.H2O2treatment.CellCycle.TIGK.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HvsT_H2O2/HvsT_H2O2 Treatment_CellCycle up in TIGK_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()
#Enrichment of HaCaT - H2O2 vs Control: Cell Cycle Genes upregulated in HaCaT after H2O2 treatment ####
enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2 <- enrichr(CellCycle.H2O2vsCtrl.HaCaT.upH2O2$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up HaCaT")
addWorksheet(Enrichments, "CC Up HaCaT")
addWorksheet(Enrichments, "MF Up HaCaT")
addWorksheet(Enrichments, "Reactome Up HaCaT")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up HaCaT", x = as.data.frame((as.data.frame(enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up HaCaT", x = as.data.frame((as.data.frame(enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up HaCaT", x = as.data.frame((as.data.frame(enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up HaCaT", x = as.data.frame((as.data.frame(enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HaCaT - H2O2 vs Control/CellCycle up in HaCaT after H2O2 treatment.xlsx")

#Dotplots for the enrichment
#GO BP
enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.GOBP<-as.data.frame(enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2$GO_Biological_Process_2023)[1:10,]
frac <- enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.GOBP$Overlap
enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.GOBP, aes(x=enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.GOBP$Adjusted.P.value, size=(enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HaCaT - H2O2 vs Control/CellCycle up in HaCaT after H2O2 treatment_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.GOMF<-as.data.frame(enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.GOMF$Overlap
enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.GOMF, aes(x=enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.GOMF$Adjusted.P.value, size=(enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HaCaT - H2O2 vs Control/CellCycle up in HaCaT after H2O2 treatment_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.GOCC<-as.data.frame(enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.GOCC$Overlap
enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.GOCC, aes(x=enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.GOCC$Adjusted.P.value, size=(enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HaCaT - H2O2 vs Control/CellCycle up in HaCaT after H2O2 treatment_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.Reactome<-as.data.frame(enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2$Reactome_2022)[1:10,]
frac <- enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.Reactome$Overlap
enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.Reactome, aes(x=enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.Reactome$Adjusted.P.value, size=(enriched.CellCycle.H2O2vsCtrl.HaCaT.upH2O2.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HaCaT - H2O2 vs Control/CellCycle up in HaCaT after H2O2 treatment_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()


##Enrichment of HaCaT - H2O2 vs Control: Cell Cycle Genes downregulated in HaCaT after H2O2 treatment ####
enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2 <- enrichr(CellCycle.H2O2vsCtrl.HaCaT.downH2O2$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up TIGK")
addWorksheet(Enrichments, "CC Up TIGK")
addWorksheet(Enrichments, "MF Up TIGK")
addWorksheet(Enrichments, "Reactome Up TIGK")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up TIGK", x = as.data.frame((as.data.frame(enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up TIGK", x = as.data.frame((as.data.frame(enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up TIGK", x = as.data.frame((as.data.frame(enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up TIGK", x = as.data.frame((as.data.frame(enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))# Export the file
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HaCaT - H2O2 vs Control/CellCycle down in HaCaT after H2O2 treatment.xlsx")


#GO BP
enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.GOBP<-as.data.frame(enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2$GO_Biological_Process_2023)[1:10,]
frac <- enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.GOBP$Overlap
enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.GOBP, aes(x=enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.GOBP$Adjusted.P.value, size=(enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HaCaT - H2O2 vs Control/CellCycle down in HaCaT after H2O2 treatment_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.GOMF<-as.data.frame(enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.GOMF$Overlap
enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.GOMF, aes(x=enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.GOMF$Adjusted.P.value, size=(enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HaCaT - H2O2 vs Control/CellCycle down in HaCaT after H2O2 treatment_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.GOCC<-as.data.frame(enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.GOCC$Overlap
enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.GOCC, aes(x=enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.GOCC$Adjusted.P.value, size=(enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HaCaT - H2O2 vs Control/CellCycle down in HaCaT after H2O2 treatment_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.Reactome<-as.data.frame(enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2$Reactome_2022)[1:7,]
frac <- enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.Reactome$Overlap
enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.Reactome, aes(x=enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.Reactome$Adjusted.P.value, size=(enriched.CellCycle.H2O2vsCtrl.HaCaT.downH2O2.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/HaCaT - H2O2 vs Control/CellCycle down in HaCaT after H2O2 treatment_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Enrichment of TIGK - H2O2 vs Control: Cell Cycle Genes upregulated in TIGK after H2O2 treatment ####
enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2 <- enrichr(CellCycle.H2O2vsCtrl.TIGK.upH2O2$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up HaCaT")
addWorksheet(Enrichments, "CC Up HaCaT")
addWorksheet(Enrichments, "MF Up HaCaT")
addWorksheet(Enrichments, "Reactome Up HaCaT")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up HaCaT", x = as.data.frame((as.data.frame(enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up HaCaT", x = as.data.frame((as.data.frame(enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up HaCaT", x = as.data.frame((as.data.frame(enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up HaCaT", x = as.data.frame((as.data.frame(enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/TIGK- H2O2 vs Control/CellCycle up in TIGK after H2O2 treatment.xlsx")

#Dotplots for the enrichment
#GO BP
enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.GOBP<-as.data.frame(enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2$GO_Biological_Process_2023)[1:10,]
frac <- enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.GOBP$Overlap
enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.GOBP, aes(x=enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.GOBP$Adjusted.P.value, size=(enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/TIGK- H2O2 vs Control/CellCycle up in TIGK after H2O2 treatment_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.GOMF<-as.data.frame(enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.GOMF$Overlap
enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.GOMF, aes(x=enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.GOMF$Adjusted.P.value, size=(enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/TIGK- H2O2 vs Control/CellCycle up in TIGK after H2O2 treatment_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.GOCC<-as.data.frame(enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.GOCC$Overlap
enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.GOCC, aes(x=enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.GOCC$Adjusted.P.value, size=(enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/TIGK- H2O2 vs Control/CellCycle up in TIGK after H2O2 treatment_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.Reactome<-as.data.frame(enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2$Reactome_2022)[1:10,]
frac <- enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.Reactome$Overlap
enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.Reactome, aes(x=enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.Reactome$Adjusted.P.value, size=(enriched.CellCycle.H2O2vsCtrl.TIGK.upH2O2.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/TIGK- H2O2 vs Control/CellCycle up in TIGK after H2O2 treatment_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()


##Enrichment of TIGK - H2O2 vs Control: Cell Cycle Genes downregulated in TIGK after H2O2 treatment ####
enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2 <- enrichr(CellCycle.H2O2vsCtrl.TIGK.downH2O2$symbol, dbs)

# Exporting HvsT Control comparisons
Enrichments <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(Enrichments, "BP Up TIGK")
addWorksheet(Enrichments, "CC Up TIGK")
addWorksheet(Enrichments, "MF Up TIGK")
addWorksheet(Enrichments, "Reactome Up TIGK")
# Write the data to the sheets
writeData(Enrichments, sheet = "BP Up TIGK", x = as.data.frame((as.data.frame(enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2$GO_Biological_Process_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "CC Up TIGK", x = as.data.frame((as.data.frame(enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2$GO_Cellular_Component_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "MF Up TIGK", x = as.data.frame((as.data.frame(enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2$GO_Molecular_Function_2023%>%filter(Adjusted.P.value < 0.05)))))
writeData(Enrichments, sheet = "Reactome Up TIGK", x = as.data.frame((as.data.frame(enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2$Reactome_2022%>%filter(Adjusted.P.value < 0.05)))))# Export the file
saveWorkbook(Enrichments, file="C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/TIGK- H2O2 vs Control/CellCycle down in TIGK after H2O2 treatment.xlsx")


#GO BP
enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.GOBP<-as.data.frame(enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2$GO_Biological_Process_2023)[1:10,]
frac <- enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.GOBP$Overlap
enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.GOBP$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.GOBP, aes(x=enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.GOBP$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.GOBP$Adjusted.P.value, size=(enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.GOBP$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/TIGK- H2O2 vs Control/CellCycle down in TIGK after H2O2 treatment_GO BP.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO - MF
enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.GOMF<-as.data.frame(enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2$GO_Molecular_Function_2023)[1:10,]
frac <- enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.GOMF$Overlap
enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.GOMF$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.GOMF, aes(x=enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.GOMF$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.GOMF$Adjusted.P.value, size=(enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.GOMF$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/TIGK- H2O2 vs Control/CellCycle down in TIGK after H2O2 treatment_GOMF.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#GO CC
enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.GOCC<-as.data.frame(enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2$GO_Cellular_Component_2023)[1:10,]
frac <- enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.GOCC$Overlap
enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.GOCC$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.GOCC, aes(x=enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.GOCC$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.GOCC$Adjusted.P.value, size=(enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.GOCC$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/TIGK- H2O2 vs Control/CellCycle down in TIGK after H2O2 treatment_GO CC.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()

#Reactome
enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.Reactome<-as.data.frame(enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2$Reactome_2022)[1:7,]
frac <- enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.Reactome$Overlap
enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.Reactome$"Gene Ratio"<-as.numeric(lapply(sapply(frac, function(x) eval(parse(text=x))), round, 3))
p1<-ggplot(enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.Reactome, aes(x=enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.Reactome$`Gene Ratio`,y=Term))+
  geom_point(aes(colour=enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.Reactome$Adjusted.P.value, size=(enriched.CellCycle.H2O2vsCtrl.TIGK.downH2O2.Reactome$`Gene Ratio`)))+
  scale_color_gradientn(colours = rainbow(5))+
  labs(x='Overlap', y=NULL,
       color='Adjusted.P.value',size='Gene Ratio')+
  theme(axis.title = element_text(face='bold'),
        axis.text = element_text(face='bold', size = 12),
        legend.text = element_text(size = 12),
        legend.title=element_text(size=12),
        panel.background = element_rect(fill = "white"),
        panel.border =element_rect(color = "black", linewidth = 0.2, fill="NA"))+
  scale_y_discrete(labels = label_wrap(30))
png("C:/Users/chenh/Desktop/DiPietro Lab_Manuscripts/Oxidative stress_TIGK vs HaCaT/R Analysis_Chen-2/Enrichment of Cell Cycle Gene/TIGK- H2O2 vs Control/CellCycle down in TIGK after H2O2 treatment_Reactome.png",
    width = 1600,
    height = 2000,
    units = "px",
    res = 250)
p1
dev.off()
